#! /usr/bin/env node
var t=require("fs"),e=require("path"),n=require("cheerio"),s=require("@babel/core"),r=require("util"),i=require("events"),o=require("assert"),a=require("readline");function c(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,l=c(t),h=c(e),p=c(n),f=c(r),d=c(i),m=c(o),g=c(a);function y(n,s=!1){const r=`${e.isAbsolute(n)?"":function(){let t;try{t=require("vscode")}catch(t){}if(t?.workspace)return`${t.workspace.workspaceFolders?.[0].uri.path}${e.sep}`;{let t=e.resolve(__dirname).split(e.sep).includes("node_modules")?3:2;return t=2,`${__dirname.split(e.sep).slice(0,-t).join(e.sep)}${e.sep}`}}()}${n}`;return s?t.realpathSync(r):r}function v(t,e,n){const s=n.reduce(((t,n)=>(t[n]={get:()=>e[n]},t)),{});Object.defineProperties(t,s)}function b(t,e,n,s){return t.substr(0,e)+s+t.substr(e+n.length)}function E(t,e=" "){return Array(t+1).map((()=>null)).join(e)}class w{constructor(t){this.component=t,v(this,this.component,["componentProvider"]),this.prepareImports()}prepareImports(){const t=p.default.load(this.component.source);this.localImports=[],this.imports=[];[...t("link[presto]")].map((t=>{const e=this.componentProvider.getComponentByHref(this,t.attribs.href);this.localImports.push(e),this.imports.push(e)})),this.imports=this.imports.concat(this.componentProvider.included)}prepareAliases(){}getComponentByExpressionName(t){return"presto-root"==t?this.componentProvider.components.slice(-1)[0]:this.imports.filter((e=>e.expressionName===t))[0]}getComponentByGivenName(t){return this.imports.find((e=>e.name===t))}}class _ extends Error{constructor(t){super();const e=Object.assign({name:"PrestoError",message:"A generic PrestoError occurred. That's all we know.",code:u.UNKNOWN,showStack:!1},t);this.name=e.name,this.message=e.message,this.code=e.code,this.showStack=e.showStack}}class O extends _{constructor(t){"string"!=typeof t.message&&(t.messageBuilder=t.message),super(t);const e=Object.assign({name:"PrestoComponentError",message:"A generic PrestoComponentError occurred. That's all we know.",showStack:!0},t);this.component=t.component,this.message=e.message,this.name=e.name,this.showStack=e.showStack,this.buildStack(),this.buildMessage(t)}buildMessage(t){this.message=void 0===t.messageBuilder?this.message:t.messageBuilder(this)}buildStack(){this.stackArr=["Import Stack:"];let t=this.component;for(;t.context instanceof w;){const e=void 0===t.file?t.path:t.file;this.stackArr.push(`${E(4)}- ${e}`),t=t.context.component}this.stackArr.push(`${E(4)}- ${t.path}`),this.stack=this.stackArr.join("\n")}}function A(t){throw t}function T(t,e){return new _({code:u.CONFIG_BAD_PROP_TYPE,name:"PrestoConfigError",message:`Property \`${t}\` of given config has incorrect type \`${typeof e}\`.`})}function S(t,e){return new _({code:u.CONFIG_BAD_PROP_VALUE,name:"PrestoConfigError",message:`Property \`${t}\` of given config has incorrect value \`${e}\`.`})}function x(t){return new _({code:u.CONFIG_MISSING_PROP,name:"PrestoConfigError",message:`Required property \`${t}\` is missing for given config.`})}!function(t){t.UNKNOWN="UNKNOWN_PRESTO_ERROR",t.NO_SUCH_FILE="NO_SUCH_FILE",t.CONFIG_BAD_PROP_TYPE="CONFIG_BAD_PROP_TYPE",t.CONFIG_BAD_PROP_VALUE="CONFIG_BAD_PROP_VALUE",t.CONFIG_MISSING_PROP="CONFIG_MISSING_PROP",t.COMPONENT_NO_META="COMPONENT_NO_META",t.COMPONENT_NO_FILE="COMPONENT_NO_FILE",t.EXPRESSION_REQUIRED_PROP="EXPRESSION_REQUIRED_PROP",t.EXPRESSION_ACTION_EXISTS="EXPRESSION_ACTION_EXISTS",t.EXPRESSION_PROP_EXISTS="EXPRESSION_PROP_EXISTS",t.COMPONENT_DEFAULT_SLOT_MIX="COMPONENT_DEFAULT_SLOT_MIX",t.COMPONENT_UNRESOLVED_UTILIZE="COMPONENT_UNRESOLVED_UTILIZE",t.COMPONENT_COALESCE_WILDCARD_DUALITY="COMPONENT_COALESCE_WILDCARD_DUALITY",t.COMPONENT_COALESCE_CONFLICT="COMPONENT_COALESCE_CONFLICT"}(u||(u={}));var $="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function C(t){var e={exports:{}};return t(e,e.exports),e.exports}var N=C((function(t,e){var n,s;Object.defineProperty(e,"__esModule",{value:!0}),e.TagTypes=e.MustacheTypes=void 0,(n=e.MustacheTypes||(e.MustacheTypes={})).SMUSTACHE="s__mustache",n.ESMUSTACHE="es__mustache",n.MUSTACHE="mustache",n.EMUSTACHE="e__mustache",(s=e.TagTypes||(e.TagTypes={})).TAG="tag",s.ETAG="e__tag"})),k=C((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getLineAndColumn=e.isEscapedMustache=e.isSafeMustache=e.isMustache=e.isEscapedTag=e.isTag=void 0,e.isTag=function(t,e){return(t.type===N.TagTypes.TAG||t.type===N.TagTypes.ETAG)&&(!e||t.properties.name===e)},e.isEscapedTag=function(t,e){return t.type===N.TagTypes.ETAG&&(!e||t.properties.name===e)},e.isMustache=function(t){return t.type===N.MustacheTypes.EMUSTACHE||t.type===N.MustacheTypes.ESMUSTACHE||t.type===N.MustacheTypes.MUSTACHE||t.type===N.MustacheTypes.SMUSTACHE},e.isSafeMustache=function(t){return t.type===N.MustacheTypes.ESMUSTACHE||t.type===N.MustacheTypes.SMUSTACHE},e.isEscapedMustache=function(t){return t.type===N.MustacheTypes.EMUSTACHE||t.type===N.MustacheTypes.ESMUSTACHE},e.getLineAndColumn=function(t){return"newline"===t.type||"raw"===t.type?[t.line,0]:[t.loc.start.line,t.loc.start.col]}})),I=C((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMustache=e.getTag=void 0;const n=/^(\s*)(@{1,2})(!)?([a-zA-Z._]+)(\s{0,2})/;e.getTag=function(t,e,s,r,i,o){const a=n.exec(t);if(!a)return null;const c=a[4];let u=i[c];if(!u&&o&&(u=o(c)),!u)return null;const l="@@"===a[2],h=!!a[3],p=a[1].length,f=a[5].length,d=u.seekable,m=u.block,g=!!u.noNewLine;return r+=p+a[2].length+c.length+f,h&&r++,{name:c,filename:e,seekable:d,selfclosed:h,block:m,line:s,col:r,escaped:l,hasBrace:d&&"("===t[r],noNewLine:g}},e.getMustache=function(t,e,n,s){const r=t.indexOf("{{");if(-1===r)return null;const i=r,o="-"===t[r+2]&&"-"===t[r+3];return o?{isComment:o,filename:e,line:n,col:s+i,realCol:i}:{isComment:o,safe:"{"===t[r+2],filename:e,escaped:"@"===t[r-1],line:n,col:s+i,realCol:i}}})),M=C((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Scanner=void 0;e.Scanner=class{constructor(t,e,n,s){this.pattern=t,this.line=n,this.col=s,this.tolaretionCounts=0,this.tolerateLhs="",this.tolerateRhs="",this.patternLength=this.pattern.length,this.closed=!1,this.match="",this.leftOver="",this.loc={line:this.line,col:this.col},this.tolerateLhs=e[0],this.tolerateRhs=e[1]}matchesPattern(t,e){for(let n=0;n<this.patternLength;n++)if(this.pattern[n]!==t[e+n])return!1;return!0}scan(t){if("\n"===t)return this.loc.line++,this.loc.col=0,void(this.match+="\n");if(!t.trim())return;const e=t.length;let n=0;for(;n<e;){const e=t[n];if(0===this.tolaretionCounts&&this.matchesPattern(t,n)){n+=this.patternLength,this.closed=!0;break}e===this.tolerateLhs&&this.tolaretionCounts++,e===this.tolerateRhs&&this.tolaretionCounts--,this.match+=e,n++}this.closed&&(this.loc.col+=n,this.leftOver=t.slice(n))}}})),P=C((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.EdgeError=void 0;class n extends Error{constructor(t,e,n){super(t),this.message=t,this.code=e,this.line=n.line,this.col=n.col,this.filename=n.filename;const s=this.stack.split("\n");s.splice(1,0,`    at anonymous (${this.filename}:${this.line}:${this.col})`),this.stack=s.join("\n")}}e.EdgeError=n})),L=C((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.unclosedTag=e.unclosedCurlyBrace=e.unopenedParen=e.unclosedParen=e.cannotSeekStatement=void 0,e.cannotSeekStatement=function(t,e,n){return new P.EdgeError(`Unexpected token "${t}"`,"E_CANNOT_SEEK_STATEMENT",{line:e.line,col:e.col,filename:n})},e.unclosedParen=function(t,e){return new P.EdgeError('Missing token ")"',"E_UNCLOSED_PAREN",{line:t.line,col:t.col,filename:e})},e.unopenedParen=function(t,e){return new P.EdgeError('Missing token "("',"E_UNOPENED_PAREN",{line:t.line,col:t.col,filename:e})},e.unclosedCurlyBrace=function(t,e){return new P.EdgeError('Missing token "}"',"E_UNCLOSED_CURLY_BRACE",{line:t.line,col:t.col,filename:e})},e.unclosedTag=function(t,e,n){return new P.EdgeError(`Unclosed tag ${t}`,"E_UNCLOSED_TAG",{line:e.line,col:e.col,filename:n})}})),j=C((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Tokenizer=void 0;e.Tokenizer=class{constructor(t,e,n){this.template=t,this.tagsDef=e,this.options=n,this.tokens=[],this.tagStatement=null,this.mustacheStatement=null,this.line=0,this.isLastLineATag=!1,this.dropNewLine=!1,this.openedTags=[]}getRawNode(t){return{type:"raw",value:t,filename:this.options.filename,line:this.line}}getNewLineNode(t){return{type:"newline",filename:this.options.filename,line:(t||this.line)-1}}getTagNode(t,e,n){return{type:t.escaped?N.TagTypes.ETAG:N.TagTypes.TAG,filename:t.filename,properties:{name:t.name,jsArg:e,selfclosed:t.selfclosed},loc:{start:{line:t.line,col:t.col},end:n},children:[]}}consumeTag(t,e,n){t.block&&!t.selfclosed?this.openedTags.push(this.getTagNode(t,e,n)):this.consumeNode(this.getTagNode(t,e,n))}handleTagOpening(t,e){if(e.seekable&&!e.hasBrace)throw L.unopenedParen({line:e.line,col:e.col},e.filename);if(!e.seekable)return this.consumeTag(e,"",{line:e.line,col:e.col}),void((e.noNewLine||t.endsWith("~"))&&(this.dropNewLine=!0));e.col+=1,this.tagStatement={tag:e,scanner:new M.Scanner(")",["(",")"],this.line,e.col)},this.feedCharsToCurrentTag(t.slice(e.col))}feedCharsToCurrentTag(t){const{tag:e,scanner:n}=this.tagStatement;if(n.scan(t),n.closed){if(this.consumeTag(e,n.match,n.loc),"~"===n.leftOver.trim())return this.tagStatement=null,void(this.dropNewLine=!0);if(n.leftOver.trim())throw L.cannotSeekStatement(n.leftOver,n.loc,e.filename);e.noNewLine&&(this.dropNewLine=!0),this.tagStatement=null}}getMustacheType(t){return t.safe?t.escaped?N.MustacheTypes.ESMUSTACHE:N.MustacheTypes.SMUSTACHE:t.escaped?N.MustacheTypes.EMUSTACHE:N.MustacheTypes.MUSTACHE}getMustacheNode(t,e,n){return{type:this.getMustacheType(t),filename:t.filename,properties:{jsArg:e},loc:{start:{line:t.line,col:t.col},end:n}}}getCommentNode(t,e,n){return{type:"comment",filename:t.filename,value:e,loc:{start:{line:t.line,col:t.col},end:n}}}handleMustacheOpening(t,e){const n=e.isComment?"--}}":e.safe?"}}}":"}}",s=e.isComment||!e.escaped?e.realCol:e.realCol-1;s>0&&this.consumeNode(this.getRawNode(t.slice(0,s))),e.col+=n.length,e.realCol+=n.length,this.mustacheStatement={mustache:e,scanner:new M.Scanner(n,["{","}"],e.line,e.col)},this.feedCharsToCurrentMustache(t.slice(e.realCol))}feedCharsToCurrentMustache(t){const{mustache:e,scanner:n}=this.mustacheStatement;if(n.scan(t),n.closed){if(e.isComment?this.consumeNode(this.getCommentNode(e,n.match,n.loc)):this.consumeNode(this.getMustacheNode(e,n.match,n.loc)),n.leftOver.trim()){const t=I.getMustache(n.leftOver,this.options.filename,n.loc.line,n.loc.col);if(t)return void this.handleMustacheOpening(n.leftOver,t);this.consumeNode(this.getRawNode(n.leftOver))}this.mustacheStatement=null}}isClosingTag(t){if(!this.openedTags.length)return!1;t=t.trim();const e=`@end${this.openedTags[this.openedTags.length-1].properties.name}`;return t===e||t===`${e}~`||"@end"===t||"@end~"===t}consumeNode(t){this.openedTags.length?this.openedTags[this.openedTags.length-1].children.push(t):this.tokens.push(t)}pushNewLine(t){1!==(t||this.line)&&(this.dropNewLine?this.dropNewLine=!1:this.consumeNode(this.getNewLineNode(t)))}processText(t){if("function"==typeof this.options.onLine&&(t=this.options.onLine(t)),this.tagStatement)return this.feedCharsToCurrentTag("\n"),void this.feedCharsToCurrentTag(t);if(this.mustacheStatement)return this.feedCharsToCurrentMustache("\n"),void this.feedCharsToCurrentMustache(t);if(this.isClosingTag(t))return this.consumeNode(this.openedTags.pop()),void(t.endsWith("~")&&(this.dropNewLine=!0));const e=I.getTag(t,this.options.filename,this.line,0,this.tagsDef,this.options.claimTag);if(e)return this.isLastLineATag&&this.pushNewLine(),this.isLastLineATag=!0,void this.handleTagOpening(t,e);this.isLastLineATag=!1;const n=I.getMustache(t,this.options.filename,this.line,0);if(n)return this.pushNewLine(),void this.handleMustacheOpening(t,n);this.pushNewLine(),this.consumeNode(this.getRawNode(t))}checkForErrors(){if(this.tagStatement){const{tag:t}=this.tagStatement;throw L.unclosedParen({line:t.line,col:t.col},t.filename)}if(this.mustacheStatement){const{mustache:t}=this.mustacheStatement;throw L.unclosedCurlyBrace({line:t.line,col:t.col},t.filename)}if(this.openedTags.length){const t=this.openedTags[this.openedTags.length-1];throw L.unclosedTag(t.properties.name,t.loc.start,t.filename)}}parse(){const t=this.template.split(/\r\n|\r|\n/g),e=t.length;for(;this.line<e;){const e=t[this.line];this.line++,this.processText(e)}this.checkForErrors()}}})),R=C((function(t,e){var n=$&&$.__createBinding||(Object.create?function(t,e,n,s){void 0===s&&(s=n),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,s){void 0===s&&(s=n),t[s]=e[n]}),s=$&&$.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=$&&$.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.utils=e.TagTypes=e.MustacheTypes=e.Tokenizer=void 0;const i=r(k);e.utils=i,Object.defineProperty(e,"Tokenizer",{enumerable:!0,get:function(){return j.Tokenizer}}),Object.defineProperty(e,"MustacheTypes",{enumerable:!0,get:function(){return N.MustacheTypes}}),Object.defineProperty(e,"TagTypes",{enumerable:!0,get:function(){return N.TagTypes}})}));const D=[{char:"=",sub:"presto-equals",safe:"&equals;"},{char:'"',sub:"presto-quote",safe:"&quot;"},{char:"<",sub:"presto-lessthan",safe:"&lt;"},{char:">",sub:"presto-greaterthan",safe:"&gt;"},{char:"`",sub:"presto-backtick",safe:"\\`"}],U=[{attr:"x-html",sub:""},{attr:"x-bind",sub:""},{attr:"value",sub:"x-model"},{attr:"x-model",sub:""},{attr:"x-text",sub:""}];function F(t,e){const{line:n,col:s}=e.loc.start;return function(t,e,n){const s=t.split("\n");let r=0;return s.slice(0,e-1).map((t=>{r=r+t.length+1})),r+=n,r}(t,n,s)}function B(t,e){return function(t,e){let n,s=[],r=[];for(n=1;n<=e;n++){const i=t.charAt(e-n);if(0!==r.length||" "!==i&&"\n"!==i)if(s.includes('"')){if(s.push(i),!s.includes("="))break;if(" "===i)break;r.push(i)}else s.push(i)}return{rel:0!==r.length?r.reverse().slice(0,-1).join(""):"html",offset:n}}(t,F(t,e))}function G(t){const e=new R.Tokenizer(t,{},{filename:""});e.parse();const n=e.tokens.filter((t=>"mustache"===t.type));let s=!1;return n.map((e=>{const n=B(t,e);s||(s="html"===n.rel)})),s}class V{constructor(t,e){this.givenKey=t,this.key=t,this.value=e,this.prepareAttribute()}prepareAttribute(){this.exposes=this.givenKey.indexOf("|")<0?"":this.givenKey.split("|")[0],this.key=""!==this.exposes?this.givenKey.split("|")[1]:this.givenKey,this.isProperty="::"===this.key.substr(0,2),this.isProperty&&(this.key=this.key.substr(2));const t=this.actions().filter((t=>t===this.key));this.action=t.length>0?t[0].substr(2):""}actions(){return["$$render","$$wrap"]}}class q{constructor(t){this.expression=t,this.prepareAttributes(),this.prepareAttributeProvides()}prepareAttributes(){const t=this.expression.element.attribs,e=Object.keys(t);this.attributes=[],this.wrapAttributes=[],e.forEach((e=>{const n=new V(e,t[e]);if(""!==n.action&&void 0!==this.getActionAttribute(n.action))return A((s=this.expression.component?.name||"INDEX",r=this.expression.context.component.path,i=e,new _({code:u.EXPRESSION_ACTION_EXISTS,name:"PrestoExpresssionError",message:`Expression "${s}" in component at "${r}" declares existing action ${i}.`})));var s,r,i;void 0!==this.getActionAttribute("wrap")?this.wrapAttributes.push(n):this.attributes.push(n)}))}getAssignedAttributes(){return(0!==(this.reservedAttributes?.length||0)||0!==(this.providedAttributes?.length||0)?this.reservedAttributes:this.attributes).filter((t=>!t.isProperty&&""===t.action&&""===t.exposes))}getActionAttribute(t){const e=this.attributes.filter((e=>e.action===t));return e.length>0?e[0].value:void 0}getPropertyAttributes(){return this.attributes.filter((t=>t.isProperty))}getActionAttributes(){return this.attributes.filter((t=>""!==t.action))}prepareAttributeProvides(){if(this.expression.component.isInputComponent)return;const{utilizesComponents:t,providesAttributes:e,reservesAttributes:n}=this.expression.component;let s=[],r=!1;t.forEach((t=>{100!==t.acceptsAttributes.length?r||(s=s.concat(t.acceptsAttributes)):r=!0}));const i=100===n.length,o=100===e.length||r&&!i;this.providedAttributes=[],this.reservedAttributes=[];const a=s.concat(e),c=n;o?this.attributes.forEach((t=>{c.includes(t.givenKey.toLowerCase())?this.reservedAttributes.push(t):this.providedAttributes.push(t)})):this.attributes.forEach((t=>{a.includes(t.givenKey.toLowerCase())?this.providedAttributes.push(t):this.reservedAttributes.push(t)}))}}class z{constructor(t,e=!1){this.key=t.key.toLowerCase(),this.value=t.value,this.empty=e,this.prepareProp()}prepareProp(){this.isMagic="$"===this.key.substr(0,1),this.isMagic&&(this.key=this.key.substr(1))}}class H{constructor(t){this.expression=t,this.componentProps=t.component.propManager,this.prepareProps()}prepareProps(){const t=this.expression.attributeManager.getPropertyAttributes();this.props=[],t.map((t=>{this.props.push(new z(t))})),this.componentProps.props.map((t=>{if(this.props.filter((e=>e.key===t.key)).length>0)return;const e=""===t.defaultValue?this.expression.output.props?.[t.key]||"":t.defaultValue;if(""===e)return;const n={key:t.key,value:e};this.props.push(new z(n))}))}getProp(t){t=t.toLowerCase();const e=this.props.filter((e=>e.key===t)),n=this.expression.output.props?.[t];return 0===e.length?void 0===n?new z({key:t,value:""},!0):new z({key:t,value:n}):e[0]}getPropValue(t,e=""){const n=this.componentProps.getProp(t),s=this.getProp(t),r=void 0===n?void 0:n.getValue(s);return""===e?r:this.pipeValue(r,e)}pipeValue(t,e){const n=void 0===t?"":t,s=this.expression.component.pipes,r=this.expression.output.pipes;return e in s?s[e](n):e in r?r[e](n):t}getMagicProps(){return this.props.filter((t=>t.isMagic))}getNormalProps(){return this.props.filter((t=>!t.isMagic))}processStandardTokens(){if(0===this.getNormalProps().length)return;const t=new R.Tokenizer(this.expression.source,{},{filename:""});t.parse();const e=t.tokens.filter((t=>"mustache"===t.type));let n=[];e.map((t=>{const e=t.properties.jsArg;let s=e,r="";if(s.indexOf("|")>=0){const t=s.split("|");t.length>2&&A(new Error(`Property exposed as "{{${s}}}" implements more than one pipe.`)),r=t[1].trim(),s=t[0]}const i=`${s.trim().toLowerCase()}`,o=this.getProp(i);let a=n.filter((t=>t.key===i&&t.pipe===r));if(o.isMagic)return;let c=this.getPropValue(i,r);a.length>0&&(c=a[0].value),n.push({key:i,pipe:r,value:c}),void 0!==c&&(this.expression.source=this.expression.source.replace(`{{${e}}}`,c))}))}processMagicTokens(){if(0===this.getMagicProps().length)return;let t=this.expression.source,e=[],n=!0;for(;n;){const s=new R.Tokenizer(t,{},{filename:""});s.parse();let r,i=s.tokens.filter((t=>"mustache"===t.type));if(e.forEach((t=>{const{jsArg:e}=t.properties;i=i.filter((t=>t.properties.jsArg!==e))})),0===i.length)break;n=1!==i.length,i.map((e=>{"html"!==B(t,e).rel&&G(t)||void 0!==r||(r=e)}));const o=r.properties.jsArg,a=this.getPropValue(o.trim()),c=F(t,r),u=B(t,r);if(void 0!==a)if("html"===u.rel){t=b(t,c-2,`{{${o}}}`,`<presto-magic>${a}</presto-magic>`);const e=p.default.load(t);let n=e("presto-magic").parent();if("name"in n[0]){const t=n[0];if("slot"===t.name&&"presto"in t.attribs){const t=n.parent();e(t).html(n.html()),n=t}}let s=n.html();s=s.replace("<presto-magic>","presto-ph-open"),s=s.replace("</presto-magic>","presto-ph-close"),D.map((t=>{const e=new RegExp(t.char,"g");s=s.replace(e,t.sub)}));let r={};r["x-html"]=`\`${s}\``,n.attr(r),n.empty(),t=e("body").html()}else{t=b(t,c-2,`{{${o}}}`,"presto-ph-open"+a+"presto-ph-close presto-magic"),t=b(t,c-(u.offset-1),"","presto-magic ")}else e.push(r)}t=t.replace(/presto-ph-open/g,"${"),t=t.replace(/presto-ph-close/g,"}"),this.expression.source=t}}class W{constructor(t,e){this.context=t,this.element=e,this.context instanceof ot?this.output=this.context:v(this,this.context,["output"]),this.initializeModules(),this.processWrap(),this.escapeUnsafeTags(),this.processCoalescence(),this.processProps(),this.commitDom(),this.processSlots(),this.next()}initializeModules(){const t=this.context.component.importManager;if(this.component=t.getComponentByExpressionName(this.element.name),this.source=this.component.source,this.component.isInputComponent){const t=new RegExp("((?<=<)head)|((?<=</)head)","gi");this.source=this.source.replace(t,"presto-head")}this.attributeManager=new q(this),this.propManager=new H(this)}processProps(){this.propManager.processStandardTokens(),this.propManager.processMagicTokens()}processCoalescence(){const t=p.default.load(this.source),{providedAttributes:e}=this.attributeManager;t("[\\$\\$accepts]").each(((n,s)=>{const r=t(s).attr("$$accepts"),i=0===r.trim().length;let o=[];const a=t(s).attr("$$rejects");let c=[];void 0!==a&&(c=a.split(" "));const u=t(s).attr("$$revises");let l=[];void 0!==u&&(l=u.split(" ")),e.forEach((t=>{""===t.exposes&&(c.includes(t.givenKey)||(i||r.indexOf(t.givenKey.toLowerCase())>=0)&&o.push(t))})),o.forEach((e=>{if(l.includes(e.givenKey))t(s).attr(e.givenKey,e.value);else{let n=t(s).attr(e.givenKey);n=void 0===n?"":`${n} `,t(s).attr(e.givenKey,`${n}${e.value}`)}})),t(s).removeAttr("$$accepts"),t(s).removeAttr("$$rejects"),t(s).removeAttr("$$revises")})),t("[\\$\\$exposes]").each(((e,n)=>{const s=t(n).attr("$$exposes");this.attributeManager.attributes.filter((t=>t.exposes===s)).forEach((e=>{const s=e.givenKey.split("|")[1];let r=t(n).attr(s);r=void 0===r?"":`${r} `,t(n).attr(s,`${r}${e.value}`)})),t(n).removeAttr("$$exposes")})),this.source=t.html()}processWrap(){let t=this.attributeManager.getActionAttribute("wrap");if(void 0===t)return;const e=this.attributeManager.wrapAttributes.map((t=>`${t.givenKey}="${t.value}"`)).join(" ");t=t.toLowerCase(),this.source=`<${t} ${e}>${this.source}</${t}>`}commitDom(){this.$=p.default.load(this.source)}processSlots(){const t=this.context.$(this.element).html();this.$("slot[presto]").each(((e,n)=>{const s=this.$(n).html();""===t.trim()?this.$(n).replaceWith(s):this.$(n).replaceWith(t)}))}escapeUnsafeTags(){at.map((t=>{const e=new RegExp(`((?<=<)${t.unescaped})|((?<=</)${t.unescaped})`,"gi");this.source=this.source.replace(e,t.escaped)}))}next(){const t=this.attributeManager.getAssignedAttributes(),e=void 0===this.attributeManager.getActionAttribute("wrap")?"body":"body > *";t.map((t=>{[...this.$(e).children()].map((e=>{let n={};n[t.key]=t.key in e.attribs?`${e.attribs[t.key]} ${t.value}`:t.value,p.default(e).attr(n)}))})),this.component.importManager.imports.map((t=>{[...this.$(t.expressionName)].map((t=>{const e=new W(this,t);p.default(t).replaceWith(p.default(e.$("body")[0]).html())}))})),this.html=this.$.html()}}let K=!("NO_COLOR"in process.env)&&("FORCE_COLOR"in process.env||"win32"===process.platform||null!=process.stdout&&process.stdout.isTTY&&process.env.TERM&&"dumb"!==process.env.TERM);const Z=(t,e,n,s)=>r=>K?t+(~(r+="").indexOf(e,4)?r.replace(n,s):r)+e:r,X=(t,e)=>Z(`[${t}m`,`[${e}m`,new RegExp(`\\x1b\\[${e}m`,"g"),`[${t}m`),Y=Object.defineProperty({},"enabled",{get:()=>K,set:t=>K=t}),Q=Z("[1m","[22m",/\x1b\[22m/g,"[22m[1m"),J=Z("[2m","[22m",/\x1b\[22m/g,"[22m[2m"),tt=X(31,39),et=X(32,39),nt=X(33,39),st=X(35,39);("0"===process.env.FORCE_COLOR||process.env.NO_COLOR)&&(Y.enabled=!1);const rt=console.error.bind(console);function it(t,e=!1){let n=t.message||t;t.name&&(n=`${t.name}: ${n}`);const s=n||t.message;rt(Q(tt(`[!] ${Q(s.toString())}`))),!t.stack||t instanceof _&&!t.showStack||rt(J(t.stack)),rt(""),e||process.exit(0)}class ot{constructor(t,e){this.instance=t,this.output=e,v(this,this.instance,["componentProvider","component"]),this.prepareOutput()}prepareOutput(){const t={type:"html",formatting:"tidy",comments:!1,mustache:!0,props:{},pipes:{}},{type:e,file:n,formatting:s,comments:r,mustache:i,props:o,pipes:a}=this.output;this.file=y(void 0===n?A(A(x("output.file"))):"string"!=typeof n?A(T("output.file",n)):n),this.type=void 0===e?t.type:"string"!=typeof e?A(T("output.type",e)):["html"].includes(e.toLowerCase())?e:A(S("output.type",e)),this.formatting=void 0===s?t.formatting:"string"!=typeof s?A(T("output.formatting",s)):["none","pretty","minify"].includes(s.toLowerCase())?s:A(S("output.formatting",s)),this.comments=void 0===r?t.comments:"boolean"!=typeof r?A(T("output.comments",r)):r,this.mustache=void 0===i?t.mustache:"boolean"!=typeof i?A(T("mustache",i)):i;const c=void 0===o?t.props:"object"!=typeof o?A(T("output.props",o)):Array.isArray(o)?A(S("output.props",o)):o;this.props={},Object.keys(c).forEach((t=>this.props[t.toLowerCase()]=c[t])),this.pipes=void 0===a?t.pipes:"object"!=typeof a?A(T("output.pipes",a)):Array.isArray(a)?A(S("output.pipes",a)):a}buildBaseExpression(){this.$=p.default.load("<presto-root/>");const n=this.$("presto-root")[0];this.expression=new W(this,n);let s=this.expression.html;s=this.collapseHeadElements(s),s=function(t){const e=p.default.load(t);e("*[presto-magic]").each(((t,n)=>{Object.keys(n.attribs).map((t=>{let s=n.attribs[t];if(s.indexOf("presto-magic")<0)return;s=s.replace(/\spresto-magic/g,""),"`"!==s.substr(0,1)&&"`"!==s.substr(-1)&&(s="`"+s+"`");let r=U.filter((e=>t.indexOf(e.attr)>=0));const i=r.length>0?r[0].sub.length>0?r[0].sub:t:`x-bind:${t}`;e(n).removeAttr(t);let o={};o[i]=s,e(n).attr(o)}))}));let n=e.html();return D.map((t=>{const e=new RegExp(t.sub,"g");n=n.replace(e,t.safe)})),n=n.replace(/presto-magic\s/g,""),n=n.replace(/presto-magic\=""\s/g,""),n}(s),at.map((t=>{const e=new RegExp(`((?<=<)${t.escaped})|((?<=</)${t.escaped})`,"g");s=s.replace(e,t.unescaped)}));const r=e.dirname(this.file);var i;t.mkdirSync(r,{recursive:!0}),t.writeFileSync(this.file,s),i=`Presto successfully compiled to \`${this.file}\``,rt(Q(et(`[*] ${Q(i)}`)))}collapseHeadElements(t){const e=p.default.load(t);let n=[];return e("presto-head").each(((t,s)=>{n.push(e(s).html()),e(s).remove()})),e("head").first().html(n.join("\n").trim()),e.html()}}const at=[{escaped:"presto-template",unescaped:"template"}];var ct=C((function(t){!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,s=0;n<t.length;n++,s+=8)e[s>>>5]|=t[n]<<24-s%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var n=[],s=0;s<t.length;s+=3)for(var r=t[s]<<16|t[s+1]<<8|t[s+2],i=0;i<4;i++)8*s+6*i<=8*t.length?n.push(e.charAt(r>>>6*(3-i)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],s=0,r=0;s<t.length;r=++s%4)0!=r&&n.push((e.indexOf(t.charAt(s-1))&Math.pow(2,-2*r+8)-1)<<2*r|e.indexOf(t.charAt(s))>>>6-2*r);return n}};t.exports=n}()})),ut={utf8:{stringToBytes:function(t){return ut.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(ut.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}},lt=ut,ht=function(t){return null!=t&&(pt(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&pt(t.slice(0,0))}(t)||!!t._isBuffer)};function pt(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var ft,dt,mt=C((function(t){!function(){var e=ct,n=lt.utf8,s=ht,r=lt.bin,i=function(t,o){t.constructor==String?t=o&&"binary"===o.encoding?r.stringToBytes(t):n.stringToBytes(t):s(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var a=e.bytesToWords(t),c=8*t.length,u=1732584193,l=-271733879,h=-1732584194,p=271733878,f=0;f<a.length;f++)a[f]=16711935&(a[f]<<8|a[f]>>>24)|4278255360&(a[f]<<24|a[f]>>>8);a[c>>>5]|=128<<c%32,a[14+(c+64>>>9<<4)]=c;var d=i._ff,m=i._gg,g=i._hh,y=i._ii;for(f=0;f<a.length;f+=16){var v=u,b=l,E=h,w=p;u=d(u,l,h,p,a[f+0],7,-680876936),p=d(p,u,l,h,a[f+1],12,-389564586),h=d(h,p,u,l,a[f+2],17,606105819),l=d(l,h,p,u,a[f+3],22,-1044525330),u=d(u,l,h,p,a[f+4],7,-176418897),p=d(p,u,l,h,a[f+5],12,1200080426),h=d(h,p,u,l,a[f+6],17,-1473231341),l=d(l,h,p,u,a[f+7],22,-45705983),u=d(u,l,h,p,a[f+8],7,1770035416),p=d(p,u,l,h,a[f+9],12,-1958414417),h=d(h,p,u,l,a[f+10],17,-42063),l=d(l,h,p,u,a[f+11],22,-1990404162),u=d(u,l,h,p,a[f+12],7,1804603682),p=d(p,u,l,h,a[f+13],12,-40341101),h=d(h,p,u,l,a[f+14],17,-1502002290),u=m(u,l=d(l,h,p,u,a[f+15],22,1236535329),h,p,a[f+1],5,-165796510),p=m(p,u,l,h,a[f+6],9,-1069501632),h=m(h,p,u,l,a[f+11],14,643717713),l=m(l,h,p,u,a[f+0],20,-373897302),u=m(u,l,h,p,a[f+5],5,-701558691),p=m(p,u,l,h,a[f+10],9,38016083),h=m(h,p,u,l,a[f+15],14,-660478335),l=m(l,h,p,u,a[f+4],20,-405537848),u=m(u,l,h,p,a[f+9],5,568446438),p=m(p,u,l,h,a[f+14],9,-1019803690),h=m(h,p,u,l,a[f+3],14,-187363961),l=m(l,h,p,u,a[f+8],20,1163531501),u=m(u,l,h,p,a[f+13],5,-1444681467),p=m(p,u,l,h,a[f+2],9,-51403784),h=m(h,p,u,l,a[f+7],14,1735328473),u=g(u,l=m(l,h,p,u,a[f+12],20,-1926607734),h,p,a[f+5],4,-378558),p=g(p,u,l,h,a[f+8],11,-2022574463),h=g(h,p,u,l,a[f+11],16,1839030562),l=g(l,h,p,u,a[f+14],23,-35309556),u=g(u,l,h,p,a[f+1],4,-1530992060),p=g(p,u,l,h,a[f+4],11,1272893353),h=g(h,p,u,l,a[f+7],16,-155497632),l=g(l,h,p,u,a[f+10],23,-1094730640),u=g(u,l,h,p,a[f+13],4,681279174),p=g(p,u,l,h,a[f+0],11,-358537222),h=g(h,p,u,l,a[f+3],16,-722521979),l=g(l,h,p,u,a[f+6],23,76029189),u=g(u,l,h,p,a[f+9],4,-640364487),p=g(p,u,l,h,a[f+12],11,-421815835),h=g(h,p,u,l,a[f+15],16,530742520),u=y(u,l=g(l,h,p,u,a[f+2],23,-995338651),h,p,a[f+0],6,-198630844),p=y(p,u,l,h,a[f+7],10,1126891415),h=y(h,p,u,l,a[f+14],15,-1416354905),l=y(l,h,p,u,a[f+5],21,-57434055),u=y(u,l,h,p,a[f+12],6,1700485571),p=y(p,u,l,h,a[f+3],10,-1894986606),h=y(h,p,u,l,a[f+10],15,-1051523),l=y(l,h,p,u,a[f+1],21,-2054922799),u=y(u,l,h,p,a[f+8],6,1873313359),p=y(p,u,l,h,a[f+15],10,-30611744),h=y(h,p,u,l,a[f+6],15,-1560198380),l=y(l,h,p,u,a[f+13],21,1309151649),u=y(u,l,h,p,a[f+4],6,-145523070),p=y(p,u,l,h,a[f+11],10,-1120210379),h=y(h,p,u,l,a[f+2],15,718787259),l=y(l,h,p,u,a[f+9],21,-343485551),u=u+v>>>0,l=l+b>>>0,h=h+E>>>0,p=p+w>>>0}return e.endian([u,l,h,p])};i._ff=function(t,e,n,s,r,i,o){var a=t+(e&n|~e&s)+(r>>>0)+o;return(a<<i|a>>>32-i)+e},i._gg=function(t,e,n,s,r,i,o){var a=t+(e&s|n&~s)+(r>>>0)+o;return(a<<i|a>>>32-i)+e},i._hh=function(t,e,n,s,r,i,o){var a=t+(e^n^s)+(r>>>0)+o;return(a<<i|a>>>32-i)+e},i._ii=function(t,e,n,s,r,i,o){var a=t+(n^(e|~s))+(r>>>0)+o;return(a<<i|a>>>32-i)+e},i._blocksize=16,i._digestsize=16,t.exports=function(t,n){if(null==t)throw new Error("Illegal argument "+t);var s=e.wordsToBytes(i(t,n));return n&&n.asBytes?s:n&&n.asString?r.bytesToString(s):e.bytesToHex(s)}}()}));class gt{constructor(t,e){this.attrib=t,this.defaultValue=e,this.optional="::?"===this.attrib.substr(0,3),this.key=this.attrib.substr(this.optional?3:2).toLowerCase()}getValue(t){return t.empty?this.defaultValue:t.value}}class yt{constructor(t){this.component=t,v(this,this.component,["meta"]),this.extractProps()}extractProps(){if(this.props=[],void 0===this.meta)return;const{attribs:t}=this.meta;Object.keys(t).filter((t=>"::"===t.substr(0,2))).map((e=>{this.props.push(new gt(e,t[e]))}))}getProp(t){t=t.toLowerCase();const e=this.props.filter((e=>e.key===t));return 0===e.length?void 0:e[0]}}class vt{constructor(t){this.prepareSlot(t)}prepareSlot(t){const e=Object.assign(t.attribs,{name:""});this.optional="presto-opt"===e.type,this.name=e.name,this.isDefault=0===this.name.length;const n=p.default(t).html();this.defaultContent=0===n.trim().length?"":n}}class bt{constructor(t){this.component=t,this.prepareSlots()}prepareSlots(){const t=p.default.load(this.component.source),e=[...t("slot[presto]")],n=[...t("slot[presto-opt]")];this.slots=[],e.concat(n).map((t=>{const e=new vt(t);(void 0!==this.getDefaultSlot()||e.isDefault&&this.slots.length>0)&&A(function(t){return new _({code:u.COMPONENT_DEFAULT_SLOT_MIX,name:"PrestoComponentError",message:`Component at "${t}" cannot declare more than one slot when a default/unnamed slot is declared.`})}(this.component.file)),this.slots.push(e)}))}getDefaultSlot(){const t=this.slots.filter((t=>t.isDefault));return 0===t.length?void 0:t[0]}}class Et{constructor(t,e){this.context=t,this.source=t.pureSource,this.component=e,this.buildOccurrences()}buildOccurrences(){const t=this.component.name,e=RegExp(`<${t}[^/]*/>`,"g"),n=RegExp(`(<${t}[^>/<]*>)`,"g"),s=RegExp(`</${t}>`,"g");let r;for(this.selfClose=[];null!==(r=e.exec(this.source));)this.selfClose.push(new wt({literal:r[0],start:r.index,end:e.lastIndex,type:dt.SELF}));for(this.startTags=[];null!==(r=n.exec(this.source));)this.startTags.push({literal:r[0],start:r.index,end:n.lastIndex,type:dt.START});for(this.closeTags=[];null!==(r=s.exec(this.source));)this.closeTags.push({literal:r[0],start:r.index,end:s.lastIndex,type:dt.END});this.occurrences=[],this.startTags.forEach(this.resolveTagPairs),this.occurrences=this.occurrences.concat(this.selfClose)}resolveTagPairs(t,e){e<this.startTags.length-1&&this.startTags[e+1].start<this.closeTags[0].start?this.resolveTagPairs(t,e+1):this.occurrences.push(new wt(t,this.closeTags.shift()))}tokenizeOccurrences(){let t=this.source;return this.occurrences.forEach((e=>{const n=e?.endTag?"¿":"Ɛ",{startTag:s}=e,r=`<${n}${E(s.literal.length-3,"~")}>`;if(t=b(t,s.start,s.literal,r),!e?.endTag)return;const{endTag:i}=e,o=`<¡${E(i.literal.length-3,"~")}>`;t=b(t,i.start,i.literal,o)})),t}processRename(e){let n=this.tokenizeOccurrences();const s=new RegExp({NAME:`(((<)|(</))${e.oldValue})`,PROPERTY:`::${e.oldValue}`}[e.type]);this.occurrences.forEach((t=>{const r=new RegExp(t?.endTag?"<¿~*>":"<Ɛ~*>"),i=t.startTag.literal,o="NAME"===e.type?"<":"::";if(n=n.replace(r,i.replace(s,`${o}${e.newValue}`)),!t?.endTag)return;const a="NAME"===e.type?e.newValue:this.component.name;n=n.replace(/<¡~*>/,`</${a}>`)})),t.writeFileSync(this.context.file,n),this.context.init()}}!function(t){t.NAME="NAME",t.PROPERTY="PROPERTY"}(ft||(ft={}));class wt{constructor(t,e){this.startTag=t,this.endTag=e}}!function(t){t.START="START",t.END="END",t.SELF="SELF"}(dt||(dt={}));class _t{constructor(t,e){this.context=t,this.path=e,v(this,this.context,["componentProvider"]),this.init()}init(){this.readSource(),this.preparePipes(),this.parseComponentMeta(),this.prepareManagers(),this.parseAttributeCoalescence(),this.escapeSource(),this.prepareDom()}parseComponentImplementations(){this.componentImplementations=[],this.importManager.imports.forEach((t=>{const e=t?.expressionName;if(void 0===e)return;const n=new RegExp(`((?<=<)${e})|((?<=</)${e})`,"gi");null!==this.source.match(n)&&this.componentImplementations.push(new Et(this,t))}))}preparePipes(){const n=p.default.load(this.source),r=[...n("script[presto]")];if(0===r.length)return void(this.pipes={});let i=n(r).html().trim();const o=mt(this.path.concat(i)),a=e.resolve(`${e.resolve(__dirname)}${e.sep}..${e.sep}.pipes`);t.mkdirSync(a,{recursive:!0});const c=e.resolve(`${a}${e.sep}${o}.cjs`);try{t.realpathSync(c)}catch{i=i.replace(/function(?=\s*.*\(.*\)\s*{)/g,"export function");const e=s.transform(i,{presets:["@babel/preset-env"]}).code;t.writeFileSync(c,e)}this.pipes=require(c)}readSource(){try{this.file=t.realpathSync(this.path),this.source=t.readFileSync(this.file,{encoding:"utf-8"}),this.pureSource=`${this.source}`}catch(t){A("ENOENT"===t.code?new O({component:this,code:u.COMPONENT_NO_FILE,name:"PrestoComponentError",message:function(t){return 2===t.stackArr.length?`No such file found for input component at path:\n${E(30)}-> ${t.component.path}.`:`No such file found for imported component at:\n${E(30)}-> ${t.component.path},\n${E(29)}linked in:\n${E(30)}-> ${t.component.context.component.file}.`}}):t)}}escapeSource(){this.escapeSelfClosing(),this.escapeUnsafeTags(),this.escapeShorthand(),this.escapeExpressions()}prepareDom(){const t=p.default.load(this.source);["script[presto]","meta[presto]","link[presto]"].forEach((e=>{t(e).each(((e,n)=>{t(n).remove()}))})),this.isInputComponent||(this.writeIncrementedExposures(t),this.writeAccepts(t));const e=t("head"),n=`<presto-head>${e.html()}</presto-head>`,s=t("body");s.html(`${n}${s.html()}`),e.empty(),this.source=s.html()}escapeExpressions(){this.importManager.componentProvider.includedList.forEach((t=>{const e=`presto-${t.replace(/[A-Z]/g,(t=>`_${t.toLowerCase()}`))}`,n=new RegExp(`((?<=<)${t})|((?<=</)${t})`,"g");this.source=this.source.replace(n,e)})),this.importManager.imports.forEach((t=>{if(this.source.indexOf(t.expressionName)>=0)return;const e=new RegExp(`((?<=<)${t.name})|((?<=</)${t.name})`,"g");this.source=this.source.replace(e,t.expressionName)}))}escapeUnsafeTags(){at.forEach((t=>{const e=new RegExp(`((?<=<)${t.unescaped})|((?<=</)${t.unescaped})`,"gi");this.source=this.source.replace(e,t.escaped)}))}parseComponentMeta(){if(this.isInputComponent)return;const t=p.default.load(this.source);if(this.meta=t("meta[presto]")[0],void 0===this.meta)return A(function(t){return new _({code:u.COMPONENT_NO_META,name:"PrestoComponentError",message:`Imported component at ${t} contains no <meta> tag for named export.`})}(this.file));this.name=this.meta.attribs.name;const e=this.name.replace(/[A-Z]/g,(t=>`_${t.toLowerCase()}`));this.expressionName=`presto-${e}`}parseAttributeCoalescence(){if(this.isInputComponent)return;this.exposes=(this.meta.attribs?.$$exposes||"").toLowerCase();const t="$$provides"in this.meta.attribs?this.meta.attribs.$$provides:"presto-no";this.providesAttributes="presto-no"===t?[]:""===t.trim()?Array(100):t.trim().split(" ").map((t=>t.toLowerCase()));const e="$$reserves"in this.meta.attribs?this.meta.attribs.$$reserves:"presto-no";if(this.reservesAttributes="presto-no"===e?[]:""===e.trim()?Array(100):e.trim().split(" ").map((t=>t.toLowerCase())),this.reservesAttributes.includes("$$declared")){const t=this.propManager.props.map((t=>`::${t.key}`)),e=this.propManager.props.map((t=>`::$${t.key}`));this.reservesAttributes=this.reservesAttributes.concat(t).concat(e)}if(!this.providesAttributes.every((t=>0===(t?.length||0)||!this.reservesAttributes.includes(t))))return A(function(t){return new _({code:u.COMPONENT_COALESCE_CONFLICT,name:"PrestoComponentError",message:`Imported component at ${t} establishes \`$$provides\` and \`$$reserves\` with conflicting specificity.`})}(this.path));const n="$$utilizes"in this.meta.attribs?this.meta.attribs.$$utilizes:"presto-no",s="presto-no"===n?[]:""===n.trim()?Array(100):n.trim().split(" ");this.utilizesComponents=s.map((t=>{const e=this.importManager.getComponentByGivenName(t);return void 0===e?A(function(t,e){return new _({code:u.COMPONENT_UNRESOLVED_UTILIZE,name:"PrestoComponentError",message:`Imported component at ${t} incorrectly $$utilizes unresolved component name \`${e}\`.`})}(this.path,t)):e}));const r="$$accepts"in this.meta.attribs?this.meta.attribs.$$accepts:"presto-no";if(this.acceptsAttributes="presto-no"===r?[]:""===r.trim()?Array(100):r.trim().split(" ").map((t=>t.toLowerCase())),this.acceptsAttributes.includes("$$declared")){const t=this.propManager.props.map((t=>`::${t.key}`)),e=this.propManager.props.map((t=>`::$${t.key}`));this.acceptsAttributes=this.acceptsAttributes.concat(t).concat(e)}return 100===this.providesAttributes.length&&100===this.reservesAttributes.length?A(function(t){return new _({code:u.COMPONENT_COALESCE_WILDCARD_DUALITY,name:"PrestoComponentError",message:`Imported component at ${t} implements wildcard on \`$$provides\` and \`$$reserves\`.`})}(this.path)):void 0}writeAccepts(t){this.utilizesComponents.forEach((e=>{const n=e.acceptsAttributes;if(0===n.length)return;const s=100===n.length;t(e.expressionName).each(((e,r)=>{const i=t(r).attr("$$accepts");if(void 0!==i){if(s)return;t(r).attr("$$accepts",`${i} ${n.join(" ")}`)}else{if(s)return void t(r).attr("$$accepts","");t(r).attr("$$accepts",n.join(" "))}}))}))}writeIncrementedExposures(t){this.utilizesComponents.forEach((e=>{const n=e.exposes;if(""===n)return;let s=1;t(e.expressionName).each(((e,r)=>{void 0===t(r).attr("$$exposes")&&(s=this.findExposureIndex(t,n,s),t(r).attr("$$exposes",`${n}${s}`),s++)}))}))}findExposureIndex(t,e,n){let s=n;for(;0!==(t(`[\\$\\$exposes='${e}${s}']`)?.length||0);)s++;return s}prepareManagers(){this.propManager=new yt(this),this.importManager=new w(this),this.isInputComponent||(this.slotManager=new bt(this))}escapeShorthand(){[{seq:/\?presto/,sub:"presto-opt:"},{seq:"::!",sub:"presto-false:"}].forEach((t=>{let e=new RegExp(t.seq,"g");this.source=this.source.replace(e,t.sub)}))}escapeSelfClosing(){this.importManager.imports.forEach((t=>{const e=new RegExp(`<${t.name}(.*)/>`,"gi");this.source=this.source.replace(e,`<${t.name}$1></${t.name}>`)}))}get isInputComponent(){return this.context instanceof ln&&this.context?.input===this.path}}var Ot="win32"===process.platform,At=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function Tt(t){return"function"==typeof t?t:function(){var t;if(At){var e=new Error;t=function(t){t&&(e.message=t.message,n(t=e))}}else t=n;return t;function n(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}()}if(h.default.normalize,Ot)var St=/(.*?)(?:[\/\\]+|$)/g;else St=/(.*?)(?:[\/]+|$)/g;if(Ot)var xt=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else xt=/^[\/]*/;var $t=function(t,e){if(t=h.default.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var n,s,r,i,o=t,a={},c={};function u(){var e=xt.exec(t);n=e[0].length,s=e[0],r=e[0],i="",Ot&&!c[r]&&(l.default.lstatSync(r),c[r]=!0)}for(u();n<t.length;){St.lastIndex=n;var p=St.exec(t);if(i=s,s+=p[0],r=i+p[1],n=St.lastIndex,!(c[r]||e&&e[r]===r)){var f;if(e&&Object.prototype.hasOwnProperty.call(e,r))f=e[r];else{var d=l.default.lstatSync(r);if(!d.isSymbolicLink()){c[r]=!0,e&&(e[r]=r);continue}var m=null;if(!Ot){var g=d.dev.toString(32)+":"+d.ino.toString(32);a.hasOwnProperty(g)&&(m=a[g])}null===m&&(l.default.statSync(r),m=l.default.readlinkSync(r)),f=h.default.resolve(i,m),e&&(e[r]=f),Ot||(a[g]=m)}t=h.default.resolve(f,t.slice(n)),u()}}return e&&(e[o]=t),t},Ct=function(t,e,n){if("function"!=typeof n&&(n=Tt(e),e=null),t=h.default.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(n.bind(null,null,e[t]));var s,r,i,o,a=t,c={},u={};function p(){var e=xt.exec(t);s=e[0].length,r=e[0],i=e[0],o="",Ot&&!u[i]?l.default.lstat(i,(function(t){if(t)return n(t);u[i]=!0,f()})):process.nextTick(f)}function f(){if(s>=t.length)return e&&(e[a]=t),n(null,t);St.lastIndex=s;var c=St.exec(t);return o=r,r+=c[0],i=o+c[1],s=St.lastIndex,u[i]||e&&e[i]===i?process.nextTick(f):e&&Object.prototype.hasOwnProperty.call(e,i)?g(e[i]):l.default.lstat(i,d)}function d(t,s){if(t)return n(t);if(!s.isSymbolicLink())return u[i]=!0,e&&(e[i]=i),process.nextTick(f);if(!Ot){var r=s.dev.toString(32)+":"+s.ino.toString(32);if(c.hasOwnProperty(r))return m(null,c[r],i)}l.default.stat(i,(function(t){if(t)return n(t);l.default.readlink(i,(function(t,e){Ot||(c[r]=e),m(t,e)}))}))}function m(t,s,r){if(t)return n(t);var i=h.default.resolve(o,s);e&&(e[r]=i),g(i)}function g(e){t=h.default.resolve(e,t.slice(s)),p()}p()},Nt=jt;jt.realpath=jt,jt.sync=Rt,jt.realpathSync=Rt,jt.monkeypatch=function(){l.default.realpath=jt,l.default.realpathSync=Rt},jt.unmonkeypatch=function(){l.default.realpath=kt,l.default.realpathSync=It};var kt=l.default.realpath,It=l.default.realpathSync,Mt=process.version,Pt=/^v[0-5]\./.test(Mt);function Lt(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function jt(t,e,n){if(Pt)return kt(t,e,n);"function"==typeof e&&(n=e,e=null),kt(t,e,(function(s,r){Lt(s)?Ct(t,e,n):n(s,r)}))}function Rt(t,e){if(Pt)return It(t,e);try{return It(t,e)}catch(n){if(Lt(n))return $t(t,e);throw n}}var Dt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Ut=Ft;function Ft(t,e,n){t instanceof RegExp&&(t=Bt(t,n)),e instanceof RegExp&&(e=Bt(e,n));var s=Gt(t,e,n);return s&&{start:s[0],end:s[1],pre:n.slice(0,s[0]),body:n.slice(s[0]+t.length,s[1]),post:n.slice(s[1]+e.length)}}function Bt(t,e){var n=e.match(t);return n?n[0]:null}function Gt(t,e,n){var s,r,i,o,a,c=n.indexOf(t),u=n.indexOf(e,c+1),l=c;if(c>=0&&u>0){for(s=[],i=n.length;l>=0&&!a;)l==c?(s.push(l),c=n.indexOf(t,l+1)):1==s.length?a=[s.pop(),u]:((r=s.pop())<i&&(i=r,o=u),u=n.indexOf(e,l+1)),l=c<u&&c>=0?c:u;s.length&&(a=[i,o])}return a}Ft.range=Gt;var Vt=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return ne(function(t){return t.split("\\\\").join(qt).split("\\{").join(zt).split("\\}").join(Ht).split("\\,").join(Wt).split("\\.").join(Kt)}(t),!0).map(Xt)},qt="\0SLASH"+Math.random()+"\0",zt="\0OPEN"+Math.random()+"\0",Ht="\0CLOSE"+Math.random()+"\0",Wt="\0COMMA"+Math.random()+"\0",Kt="\0PERIOD"+Math.random()+"\0";function Zt(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Xt(t){return t.split(qt).join("\\").split(zt).join("{").split(Ht).join("}").split(Wt).join(",").split(Kt).join(".")}function Yt(t){if(!t)return[""];var e=[],n=Ut("{","}",t);if(!n)return t.split(",");var s=n.pre,r=n.body,i=n.post,o=s.split(",");o[o.length-1]+="{"+r+"}";var a=Yt(i);return i.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function Qt(t){return"{"+t+"}"}function Jt(t){return/^-?0\d/.test(t)}function te(t,e){return t<=e}function ee(t,e){return t>=e}function ne(t,e){var n=[],s=Ut("{","}",t);if(!s||/\$$/.test(s.pre))return[t];var r,i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),a=i||o,c=s.body.indexOf(",")>=0;if(!a&&!c)return s.post.match(/,.*\}/)?ne(t=s.pre+"{"+s.body+Ht+s.post):[t];if(a)r=s.body.split(/\.\./);else if(1===(r=Yt(s.body)).length&&1===(r=ne(r[0],!1).map(Qt)).length)return(h=s.post.length?ne(s.post,!1):[""]).map((function(t){return s.pre+r[0]+t}));var u,l=s.pre,h=s.post.length?ne(s.post,!1):[""];if(a){var p=Zt(r[0]),f=Zt(r[1]),d=Math.max(r[0].length,r[1].length),m=3==r.length?Math.abs(Zt(r[2])):1,g=te;f<p&&(m*=-1,g=ee);var y=r.some(Jt);u=[];for(var v=p;g(v,f);v+=m){var b;if(o)"\\"===(b=String.fromCharCode(v))&&(b="");else if(b=String(v),y){var E=d-b.length;if(E>0){var w=new Array(E+1).join("0");b=v<0?"-"+w+b.slice(1):w+b}}u.push(b)}}else u=function(t,e){for(var n=[],s=0;s<t.length;s++){var r=e(t[s],s);Dt(r)?n.push.apply(n,r):n.push(r)}return n}(r,(function(t){return ne(t,!1)}));for(var _=0;_<u.length;_++)for(var O=0;O<h.length;O++){var A=l+u[_]+h[O];(!e||a||A)&&n.push(A)}return n}var se=le;le.Minimatch=he;var re={sep:"/"};try{re=h.default}catch(t){}var ie=le.GLOBSTAR=he.GLOBSTAR={},oe={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},ae="().*{}+?[]^$\\!".split("").reduce((function(t,e){return t[e]=!0,t}),{});var ce=/\/+/;function ue(t,e){t=t||{},e=e||{};var n={};return Object.keys(e).forEach((function(t){n[t]=e[t]})),Object.keys(t).forEach((function(e){n[e]=t[e]})),n}function le(t,e,n){if("string"!=typeof e)throw new TypeError("glob pattern string required");return n||(n={}),!(!n.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new he(e,n).match(t))}function he(t,e){if(!(this instanceof he))return new he(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==re.sep&&(t=t.split(re.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function pe(t,e){if(e||(e=this instanceof he?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:Vt(t)}le.filter=function(t,e){return e=e||{},function(n,s,r){return le(n,t,e)}},le.defaults=function(t){if(!t||!Object.keys(t).length)return le;var e=le,n=function(n,s,r){return e.minimatch(n,s,ue(t,r))};return n.Minimatch=function(n,s){return new e.Minimatch(n,ue(t,s))},n},he.defaults=function(t){return t&&Object.keys(t).length?le.defaults(t).Minimatch:he},he.prototype.debug=function(){},he.prototype.make=function(){if(this._made)return;var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error);this.debug(this.pattern,n),n=this.globParts=n.map((function(t){return t.split(ce)})),this.debug(this.pattern,n),n=n.map((function(t,e,n){return t.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(t){return-1===t.indexOf(!1)})),this.debug(this.pattern,n),this.set=n},he.prototype.parseNegate=function(){var t=this.pattern,e=!1,n=this.options,s=0;if(n.nonegate)return;for(var r=0,i=t.length;r<i&&"!"===t.charAt(r);r++)e=!e,s++;s&&(this.pattern=t.substr(s));this.negate=e},le.braceExpand=function(t,e){return pe(t,e)},he.prototype.braceExpand=pe,he.prototype.parse=function(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===t)return ie;if(""===t)return"";var s,r="",i=!!n.nocase,o=!1,a=[],c=[],u=!1,l=-1,h=-1,p="."===t.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",f=this;function d(){if(s){switch(s){case"*":r+="[^/]*?",i=!0;break;case"?":r+="[^/]",i=!0;break;default:r+="\\"+s}f.debug("clearStateChar %j %j",s,r),s=!1}}for(var m,g=0,y=t.length;g<y&&(m=t.charAt(g));g++)if(this.debug("%s\t%s %s %j",t,g,r,m),o&&ae[m])r+="\\"+m,o=!1;else switch(m){case"/":return!1;case"\\":d(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,g,r,m),u){this.debug("  in class"),"!"===m&&g===h+1&&(m="^"),r+=m;continue}f.debug("call clearStateChar %j",s),d(),s=m,n.noext&&d();continue;case"(":if(u){r+="(";continue}if(!s){r+="\\(";continue}a.push({type:s,start:g-1,reStart:r.length,open:oe[s].open,close:oe[s].close}),r+="!"===s?"(?:(?!(?:":"(?:",this.debug("plType %j %j",s,r),s=!1;continue;case")":if(u||!a.length){r+="\\)";continue}d(),i=!0;var v=a.pop();r+=v.close,"!"===v.type&&c.push(v),v.reEnd=r.length;continue;case"|":if(u||!a.length||o){r+="\\|",o=!1;continue}d(),r+="|";continue;case"[":if(d(),u){r+="\\"+m;continue}u=!0,h=g,l=r.length,r+=m;continue;case"]":if(g===h+1||!u){r+="\\"+m,o=!1;continue}if(u){var b=t.substring(h+1,g);try{RegExp("["+b+"]")}catch(t){var E=this.parse(b,fe);r=r.substr(0,l)+"\\["+E[0]+"\\]",i=i||E[1],u=!1;continue}}i=!0,u=!1,r+=m;continue;default:d(),o?o=!1:!ae[m]||"^"===m&&u||(r+="\\"),r+=m}u&&(b=t.substr(h+1),E=this.parse(b,fe),r=r.substr(0,l)+"\\["+E[0],i=i||E[1]);for(v=a.pop();v;v=a.pop()){var w=r.slice(v.reStart+v.open.length);this.debug("setting tail",r,v),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(t,e,n){return n||(n="\\"),e+e+n+"|"})),this.debug("tail=%j\n   %s",w,w,v,r);var _="*"===v.type?"[^/]*?":"?"===v.type?"[^/]":"\\"+v.type;i=!0,r=r.slice(0,v.reStart)+_+"\\("+w}d(),o&&(r+="\\\\");var O=!1;switch(r.charAt(0)){case".":case"[":case"(":O=!0}for(var A=c.length-1;A>-1;A--){var T=c[A],S=r.slice(0,T.reStart),x=r.slice(T.reStart,T.reEnd-8),$=r.slice(T.reEnd-8,T.reEnd),C=r.slice(T.reEnd);$+=C;var N=S.split("(").length-1,k=C;for(g=0;g<N;g++)k=k.replace(/\)[+*?]?/,"");var I="";""===(C=k)&&e!==fe&&(I="$"),r=S+x+C+I+$}""!==r&&i&&(r="(?=.)"+r);O&&(r=p+r);if(e===fe)return[r,i];if(!i)return function(t){return t.replace(/\\(.)/g,"$1")}(t);var M=n.nocase?"i":"";try{var P=new RegExp("^"+r+"$",M)}catch(t){return new RegExp("$.")}return P._glob=t,P._src=r,P};var fe={};le.makeRe=function(t,e){return new he(t,e||{}).makeRe()},he.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,n=e.noglobstar?"[^/]*?":e.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",s=e.nocase?"i":"",r=t.map((function(t){return t.map((function(t){return t===ie?n:"string"==typeof t?function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(t):t._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,s)}catch(t){this.regexp=!1}return this.regexp},le.match=function(t,e,n){var s=new he(e,n=n||{});return t=t.filter((function(t){return s.match(t)})),s.options.nonull&&!t.length&&t.push(e),t},he.prototype.match=function(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var n=this.options;"/"!==re.sep&&(t=t.split(re.sep).join("/"));t=t.split(ce),this.debug(this.pattern,"split",t);var s,r,i=this.set;for(this.debug(this.pattern,"set",i),r=t.length-1;r>=0&&!(s=t[r]);r--);for(r=0;r<i.length;r++){var o=i[r],a=t;if(n.matchBase&&1===o.length&&(a=[s]),this.matchOne(a,o,e))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},he.prototype.matchOne=function(t,e,n){var s=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var r=0,i=0,o=t.length,a=e.length;r<o&&i<a;r++,i++){this.debug("matchOne loop");var c,u=e[i],l=t[r];if(this.debug(e,u,l),!1===u)return!1;if(u===ie){this.debug("GLOBSTAR",[e,u,l]);var h=r,p=i+1;if(p===a){for(this.debug("** at the end");r<o;r++)if("."===t[r]||".."===t[r]||!s.dot&&"."===t[r].charAt(0))return!1;return!0}for(;h<o;){var f=t[h];if(this.debug("\nglobstar while",t,h,e,p,f),this.matchOne(t.slice(h),e.slice(p),n))return this.debug("globstar found match!",h,o,f),!0;if("."===f||".."===f||!s.dot&&"."===f.charAt(0)){this.debug("dot detected!",t,h,e,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!n||(this.debug("\n>>> no match, partial?",t,h,e,p),h!==o))}if("string"==typeof u?(c=s.nocase?l.toLowerCase()===u.toLowerCase():l===u,this.debug("string match",u,l,c)):(c=l.match(u),this.debug("pattern match",u,l,c)),!c)return!1}if(r===o&&i===a)return!0;if(r===o)return n;if(i===a)return r===o-1&&""===t[r];throw new Error("wtf?")};var de=C((function(t){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}})),me=C((function(t){try{var e=f.default;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=de}}));function ge(t){return"/"===t.charAt(0)}function ye(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),n=e[1]||"",s=Boolean(n&&":"!==n.charAt(1));return Boolean(e[2]||s)}var ve="win32"===process.platform?ye:ge,be=ge,Ee=ye;ve.posix=be,ve.win32=Ee;var we=Me,_e=Ie,Oe=function(t,e,n){n||(n={});if(n.matchBase&&-1===e.indexOf("/")){if(n.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!n.silent,t.pattern=e,t.strict=!1!==n.strict,t.realpath=!!n.realpath,t.realpathCache=n.realpathCache||Object.create(null),t.follow=!!n.follow,t.dot=!!n.dot,t.mark=!!n.mark,t.nodir=!!n.nodir,t.nodir&&(t.mark=!0);t.sync=!!n.sync,t.nounique=!!n.nounique,t.nonull=!!n.nonull,t.nosort=!!n.nosort,t.nocase=!!n.nocase,t.stat=!!n.stat,t.noprocess=!!n.noprocess,t.absolute=!!n.absolute,t.maxLength=n.maxLength||1/0,t.cache=n.cache||Object.create(null),t.statCache=n.statCache||Object.create(null),t.symlinks=n.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(Pe))}(t,n),t.changedCwd=!1;var s=process.cwd();Ne(n,"cwd")?(t.cwd=h.default.resolve(n.cwd),t.changedCwd=t.cwd!==s):t.cwd=s;t.root=n.root||h.default.resolve(t.cwd,"/"),t.root=h.default.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/"));t.cwdAbs=ve(t.cwd)?t.cwd:Le(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/"));t.nomount=!!n.nomount,n.nonegate=!0,n.nocomment=!0,t.minimatch=new ke(e,n),t.options=t.minimatch.options},Ae=Ne,Te=Le,Se=function(t){for(var e=t.nounique,n=e?[]:Object.create(null),s=0,r=t.matches.length;s<r;s++){var i=t.matches[s];if(i&&0!==Object.keys(i).length){var o=Object.keys(i);e?n.push.apply(n,o):o.forEach((function(t){n[t]=!0}))}else if(t.nonull){var a=t.minimatch.globSet[s];e?n.push(a):n[a]=!0}}e||(n=Object.keys(n));t.nosort||(n=n.sort(t.nocase?Ie:Me));if(t.mark){for(s=0;s<n.length;s++)n[s]=t._mark(n[s]);t.nodir&&(n=n.filter((function(e){var n=!/\/$/.test(e),s=t.cache[e]||t.cache[Le(t,e)];return n&&s&&(n="DIR"!==s&&!Array.isArray(s)),n})))}t.ignore.length&&(n=n.filter((function(e){return!je(t,e)})));t.found=n},xe=function(t,e){var n=Le(t,e),s=t.cache[n],r=e;if(s){var i="DIR"===s||Array.isArray(s),o="/"===e.slice(-1);if(i&&!o?r+="/":!i&&o&&(r=r.slice(0,-1)),r!==e){var a=Le(t,r);t.statCache[a]=t.statCache[n],t.cache[a]=t.cache[n]}}return r},$e=je,Ce=function(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return!(!t.gmatcher||!t.gmatcher.match(e))}))};function Ne(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var ke=se.Minimatch;function Ie(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function Me(t,e){return t.localeCompare(e)}function Pe(t){var e=null;if("/**"===t.slice(-3)){var n=t.replace(/(\/\*\*)+$/,"");e=new ke(n,{dot:!0})}return{matcher:new ke(t,{dot:!0}),gmatcher:e}}function Le(t,e){var n=e;return n="/"===e.charAt(0)?h.default.join(t.root,e):ve(e)||""===e?e:t.changedCwd?h.default.resolve(t.cwd,e):h.default.resolve(e),"win32"===process.platform&&(n=n.replace(/\\/g,"/")),n}function je(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))}))}var Re={alphasort:we,alphasorti:_e,setopts:Oe,ownProp:Ae,makeAbs:Te,finish:Se,mark:xe,isIgnored:$e,childrenIgnored:Ce},De=Ve;Ve.GlobSync=qe;var Ue=Re.setopts,Fe=Re.ownProp,Be=Re.childrenIgnored,Ge=Re.isIgnored;function Ve(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new qe(t,e).found}function qe(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof qe))return new qe(t,e);if(Ue(this,t,e),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var s=0;s<n;s++)this._process(this.minimatch.set[s],s,!1);this._finish()}qe.prototype._finish=function(){if(m.default(this instanceof qe),this.realpath){var t=this;this.matches.forEach((function(e,n){var s=t.matches[n]=Object.create(null);for(var r in e)try{r=t._makeAbs(r),s[Nt.realpathSync(r,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;s[t._makeAbs(r)]=!0}}))}Re.finish(this)},qe.prototype._process=function(t,e,n){m.default(this instanceof qe);for(var s,r=0;"string"==typeof t[r];)r++;switch(r){case t.length:return void this._processSimple(t.join("/"),e);case 0:s=null;break;default:s=t.slice(0,r).join("/")}var i,o=t.slice(r);null===s?i=".":ve(s)||ve(t.join("/"))?(s&&ve(s)||(s="/"+s),i=s):i=s;var a=this._makeAbs(i);Be(this,i)||(o[0]===se.GLOBSTAR?this._processGlobStar(s,i,a,o,e,n):this._processReaddir(s,i,a,o,e,n))},qe.prototype._processReaddir=function(t,e,n,s,r,i){var o=this._readdir(n,i);if(o){for(var a=s[0],c=!!this.minimatch.negate,u=a._glob,l=this.dot||"."===u.charAt(0),p=[],f=0;f<o.length;f++){if("."!==(g=o[f]).charAt(0)||l)(c&&!t?!g.match(a):g.match(a))&&p.push(g)}var d=p.length;if(0!==d)if(1!==s.length||this.mark||this.stat){s.shift();for(f=0;f<d;f++){var m;g=p[f];m=t?[t,g]:[g],this._process(m.concat(s),r,i)}}else{this.matches[r]||(this.matches[r]=Object.create(null));for(var f=0;f<d;f++){var g=p[f];t&&(g="/"!==t.slice(-1)?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=h.default.join(this.root,g)),this._emitMatch(r,g)}}}},qe.prototype._emitMatch=function(t,e){if(!Ge(this,e)){var n=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=n),!this.matches[t][e]){if(this.nodir){var s=this.cache[n];if("DIR"===s||Array.isArray(s))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},qe.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,n;try{n=l.default.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var s=n&&n.isSymbolicLink();return this.symlinks[t]=s,s||!n||n.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},qe.prototype._readdir=function(t,e){if(e&&!Fe(this.symlinks,t))return this._readdirInGlobStar(t);if(Fe(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(t,l.default.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},qe.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var s=e[n];s="/"===t?t+s:t+"/"+s,this.cache[s]=!0}return this.cache[t]=e,e},qe.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var s=new Error(e.code+" invalid cwd "+this.cwd);throw s.path=this.cwd,s.code=e.code,s}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},qe.prototype._processGlobStar=function(t,e,n,s,r,i){var o=this._readdir(n,i);if(o){var a=s.slice(1),c=t?[t]:[],u=c.concat(a);this._process(u,r,!1);var l=o.length;if(!this.symlinks[n]||!i)for(var h=0;h<l;h++){if("."!==o[h].charAt(0)||this.dot){var p=c.concat(o[h],a);this._process(p,r,!0);var f=c.concat(o[h],s);this._process(f,r,!0)}}}},qe.prototype._processSimple=function(t,e){var n=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),n){if(t&&ve(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=h.default.join(this.root,t):(t=h.default.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},qe.prototype._stat=function(t){var e=this._makeAbs(t),n="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&Fe(this.cache,e)){var s=this.cache[e];if(Array.isArray(s)&&(s="DIR"),!n||"DIR"===s)return s;if(n&&"FILE"===s)return!1}var r=this.statCache[e];if(!r){var i;try{i=l.default.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(i&&i.isSymbolicLink())try{r=l.default.statSync(e)}catch(t){r=i}else r=i}this.statCache[e]=r;s=!0;return r&&(s=r.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,(!n||"FILE"!==s)&&s},qe.prototype._mark=function(t){return Re.mark(this,t)},qe.prototype._makeAbs=function(t){return Re.makeAbs(this,t)};var ze=function t(e,n){if(e&&n)return t(e)(n);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){s[t]=e[t]})),s;function s(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var s=e.apply(this,t),r=t[t.length-1];return"function"==typeof s&&s!==r&&Object.keys(r).forEach((function(t){s[t]=r[t]})),s}};var He=ze(Ke),We=ze(Ze);function Ke(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function Ze(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return e.onceError=n+" shouldn't be called more than once",e.called=!1,e}Ke.proto=Ke((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Ke(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Ze(this)},configurable:!0})})),He.strict=We;var Xe=Object.create(null),Ye=ze((function(t,e){return Xe[t]?(Xe[t].push(e),null):(Xe[t]=[e],function(t){return He((function e(){var n=Xe[t],s=n.length,r=Qe(arguments);try{for(var i=0;i<s;i++)n[i].apply(null,r)}finally{n.length>s?(n.splice(0,s),process.nextTick((function(){e.apply(null,r)}))):delete Xe[t]}}))}(t))}));function Qe(t){for(var e=t.length,n=[],s=0;s<e;s++)n[s]=t[s];return n}var Je=on,tn=d.default.EventEmitter,en=Re.setopts,nn=Re.ownProp,sn=Re.childrenIgnored,rn=Re.isIgnored;function on(t,e,n){if("function"==typeof e&&(n=e,e={}),e||(e={}),e.sync){if(n)throw new TypeError("callback provided to sync glob");return De(t,e)}return new cn(t,e,n)}on.sync=De;var an=on.GlobSync=De.GlobSync;function cn(t,e,n){if("function"==typeof e&&(n=e,e=null),e&&e.sync){if(n)throw new TypeError("callback provided to sync glob");return new an(t,e)}if(!(this instanceof cn))return new cn(t,e,n);en(this,t,e),this._didRealPath=!1;var s=this.minimatch.set.length;this.matches=new Array(s),"function"==typeof n&&(n=He(n),this.on("error",n),this.on("end",(function(t){n(null,t)})));var r=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===s)return o();for(var i=0;i<s;i++)this._process(this.minimatch.set[i],i,!1,o);function o(){--r._processing,r._processing<=0&&r._finish()}}on.glob=on,on.hasMagic=function(t,e){var n=function(t,e){if(null===e||"object"!=typeof e)return t;for(var n=Object.keys(e),s=n.length;s--;)t[n[s]]=e[n[s]];return t}({},e);n.noprocess=!0;var s=new cn(t,n).minimatch.set;if(!t)return!1;if(s.length>1)return!0;for(var r=0;r<s[0].length;r++)if("string"!=typeof s[0][r])return!0;return!1},on.Glob=cn,me(cn,tn),cn.prototype._finish=function(){if(m.default(this instanceof cn),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Re.finish(this),this.emit("end",this.found)}},cn.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,n=0;n<this.matches.length;n++)this._realpathSet(n,s)}function s(){0==--t&&e._finish()}},cn.prototype._realpathSet=function(t,e){var n=this.matches[t];if(!n)return e();var s=Object.keys(n),r=this,i=s.length;if(0===i)return e();var o=this.matches[t]=Object.create(null);s.forEach((function(n,s){n=r._makeAbs(n),Nt.realpath(n,r.realpathCache,(function(s,a){s?"stat"===s.syscall?o[n]=!0:r.emit("error",s):o[a]=!0,0==--i&&(r.matches[t]=o,e())}))}))},cn.prototype._mark=function(t){return Re.mark(this,t)},cn.prototype._makeAbs=function(t){return Re.makeAbs(this,t)},cn.prototype.abort=function(){this.aborted=!0,this.emit("abort")},cn.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},cn.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var n=t[e];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var s=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<s.length;e++){var r=s[e];this._processing--,this._process(r[0],r[1],r[2],r[3])}}}},cn.prototype._process=function(t,e,n,s){if(m.default(this instanceof cn),m.default("function"==typeof s),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,n,s]);else{for(var r,i=0;"string"==typeof t[i];)i++;switch(i){case t.length:return void this._processSimple(t.join("/"),e,s);case 0:r=null;break;default:r=t.slice(0,i).join("/")}var o,a=t.slice(i);null===r?o=".":ve(r)||ve(t.join("/"))?(r&&ve(r)||(r="/"+r),o=r):o=r;var c=this._makeAbs(o);if(sn(this,o))return s();a[0]===se.GLOBSTAR?this._processGlobStar(r,o,c,a,e,n,s):this._processReaddir(r,o,c,a,e,n,s)}},cn.prototype._processReaddir=function(t,e,n,s,r,i,o){var a=this;this._readdir(n,i,(function(c,u){return a._processReaddir2(t,e,n,s,r,i,u,o)}))},cn.prototype._processReaddir2=function(t,e,n,s,r,i,o,a){if(!o)return a();for(var c=s[0],u=!!this.minimatch.negate,l=c._glob,p=this.dot||"."===l.charAt(0),f=[],d=0;d<o.length;d++){if("."!==(g=o[d]).charAt(0)||p)(u&&!t?!g.match(c):g.match(c))&&f.push(g)}var m=f.length;if(0===m)return a();if(1===s.length&&!this.mark&&!this.stat){this.matches[r]||(this.matches[r]=Object.create(null));for(d=0;d<m;d++){var g=f[d];t&&(g="/"!==t?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=h.default.join(this.root,g)),this._emitMatch(r,g)}return a()}s.shift();for(d=0;d<m;d++){g=f[d];t&&(g="/"!==t?t+"/"+g:t+g),this._process([g].concat(s),r,i,a)}a()},cn.prototype._emitMatch=function(t,e){if(!this.aborted&&!rn(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var n=ve(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=n),!this.matches[t][e]){if(this.nodir){var s=this.cache[n];if("DIR"===s||Array.isArray(s))return}this.matches[t][e]=!0;var r=this.statCache[n];r&&this.emit("stat",e,r),this.emit("match",e)}}},cn.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var n=this,s=Ye("lstat\0"+t,(function(s,r){if(s&&"ENOENT"===s.code)return e();var i=r&&r.isSymbolicLink();n.symlinks[t]=i,i||!r||r.isDirectory()?n._readdir(t,!1,e):(n.cache[t]="FILE",e())}));s&&l.default.lstat(t,s)}},cn.prototype._readdir=function(t,e,n){if(!this.aborted&&(n=Ye("readdir\0"+t+"\0"+e,n))){if(e&&!nn(this.symlinks,t))return this._readdirInGlobStar(t,n);if(nn(this.cache,t)){var s=this.cache[t];if(!s||"FILE"===s)return n();if(Array.isArray(s))return n(null,s)}l.default.readdir(t,function(t,e,n){return function(s,r){s?t._readdirError(e,s,n):t._readdirEntries(e,r,n)}}(this,t,n))}},cn.prototype._readdirEntries=function(t,e,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var s=0;s<e.length;s++){var r=e[s];r="/"===t?t+r:t+"/"+r,this.cache[r]=!0}return this.cache[t]=e,n(null,e)}},cn.prototype._readdirError=function(t,e,n){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var s=this._makeAbs(t);if(this.cache[s]="FILE",s===this.cwdAbs){var r=new Error(e.code+" invalid cwd "+this.cwd);r.path=this.cwd,r.code=e.code,this.emit("error",r),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return n()}},cn.prototype._processGlobStar=function(t,e,n,s,r,i,o){var a=this;this._readdir(n,i,(function(c,u){a._processGlobStar2(t,e,n,s,r,i,u,o)}))},cn.prototype._processGlobStar2=function(t,e,n,s,r,i,o,a){if(!o)return a();var c=s.slice(1),u=t?[t]:[],l=u.concat(c);this._process(l,r,!1,a);var h=this.symlinks[n],p=o.length;if(h&&i)return a();for(var f=0;f<p;f++){if("."!==o[f].charAt(0)||this.dot){var d=u.concat(o[f],c);this._process(d,r,!0,a);var m=u.concat(o[f],s);this._process(m,r,!0,a)}}a()},cn.prototype._processSimple=function(t,e,n){var s=this;this._stat(t,(function(r,i){s._processSimple2(t,e,r,i,n)}))},cn.prototype._processSimple2=function(t,e,n,s,r){if(this.matches[e]||(this.matches[e]=Object.create(null)),!s)return r();if(t&&ve(t)&&!this.nomount){var i=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=h.default.join(this.root,t):(t=h.default.resolve(this.root,t),i&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),r()},cn.prototype._stat=function(t,e){var n=this._makeAbs(t),s="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&nn(this.cache,n)){var r=this.cache[n];if(Array.isArray(r)&&(r="DIR"),!s||"DIR"===r)return e(null,r);if(s&&"FILE"===r)return e()}var i=this.statCache[n];if(void 0!==i){if(!1===i)return e(null,i);var o=i.isDirectory()?"DIR":"FILE";return s&&"FILE"===o?e():e(null,o,i)}var a=this,c=Ye("stat\0"+n,(function(s,r){if(r&&r.isSymbolicLink())return l.default.stat(n,(function(s,i){s?a._stat2(t,n,null,r,e):a._stat2(t,n,s,i,e)}));a._stat2(t,n,s,r,e)}));c&&l.default.lstat(n,c)},cn.prototype._stat2=function(t,e,n,s,r){if(n&&("ENOENT"===n.code||"ENOTDIR"===n.code))return this.statCache[e]=!1,r();var i="/"===t.slice(-1);if(this.statCache[e]=s,"/"===e.slice(-1)&&s&&!s.isDirectory())return r(null,!1,s);var o=!0;return s&&(o=s.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||o,i&&"FILE"===o?r():r(null,o,s)};class un{constructor(t){this.instance=t,this.components=[],this.included=[],this.includedList=[],this.readIncludedNames()}readIncludedNames(){this.instance.include.reduce(((t,e)=>t.concat(Je.sync(y(e),{}))),[]).forEach((e=>{try{const n=t.readFileSync(e,{encoding:"utf-8"}),s=p.default.load(n);s("meta[presto]").each(((t,e)=>{const n=s(e).attr("name");void 0!==n&&this.includedList.push(n)}))}catch(t){}})),this.includedList.sort(((t,e)=>e.length-t.length))}prepareIncluded(){this.instance.include.reduce(((t,e)=>t.concat(Je.sync(y(e),{}))),[]).forEach((t=>{try{const e=this.getComponentByHref(this.instance,t);this.included.push(e)}catch(e){rt(Q(nt(`[?] PrestoWarning: ${Q(`Invalid component at glob-resolved inclusion ${t}`)}`))),e instanceof _&&function(t){rt(Q(st(`     -> ${Q(t)}`)))}(e.message)}}))}getComponentByHref(t,e){const n=this.resolveHref(t,e),s=this.components.filter((t=>t.file===n)),r=0===s.length?new _t(t,n):s[0];return 0===s.length&&this.components.push(r),r}resolveHref(t,n){return`${e.isAbsolute(n)?"":(s=t.component.file,`${e.dirname(s)}${e.sep}`)}${n}`;var s}}class ln{constructor(t){this.config=t,this.prepareConfig(),this.initializeModules(),this.prepareInput(),this.prepareOutputs()}initializeModules(){this.componentProvider=new un(this),this.componentProvider.prepareIncluded()}prepareOutputs(){let{output:t}=this.config;t=void 0===t?A(x("output")):"object"==typeof t?Array.isArray(t)?t:[t]:A(T("config",t)),this.outputs=[],t.map((t=>{this.outputs.push(new ot(this,t))}))}prepareInput(){const{input:t}=this.config;this.input=y(void 0===t?A(x("input")):"string"!=typeof t?A(T("input",t)):t),this.component=this.componentProvider.getComponentByHref(this,this.input)}prepareConfig(){const{include:t,lazy:e,mustache:n}=this.config;this.include=void 0===t?[]:"string"==typeof t?[t]:Array.isArray(t)?t:A(T("include",t)),this.lazy=void 0!==e&&("boolean"!=typeof e?A(T("lazy",e)):e)}}var hn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",dn="[\\ud800-\\udfff]",mn="["+fn+"]",gn="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",yn="\\d+",vn="[\\u2700-\\u27bf]",bn="[a-z\\xdf-\\xf6\\xf8-\\xff]",En="[^\\ud800-\\udfff"+fn+yn+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",wn="\\ud83c[\\udffb-\\udfff]",_n="[^\\ud800-\\udfff]",On="(?:\\ud83c[\\udde6-\\uddff]){2}",An="[\\ud800-\\udbff][\\udc00-\\udfff]",Tn="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Sn="(?:"+bn+"|"+En+")",xn="(?:"+Tn+"|"+En+")",$n="(?:"+gn+"|"+wn+")"+"?",Cn="[\\ufe0e\\ufe0f]?"+$n+("(?:\\u200d(?:"+[_n,On,An].join("|")+")[\\ufe0e\\ufe0f]?"+$n+")*"),Nn="(?:"+[vn,On,An].join("|")+")"+Cn,kn="(?:"+[_n+gn+"?",gn,On,An,dn].join("|")+")",In=RegExp("['’]","g"),Mn=RegExp(gn,"g"),Pn=RegExp(wn+"(?="+wn+")|"+kn+Cn,"g"),Ln=RegExp([Tn+"?"+bn+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[mn,Tn,"$"].join("|")+")",xn+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[mn,Tn+Sn,"$"].join("|")+")",Tn+"?"+Sn+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Tn+"+(?:['’](?:D|LL|M|RE|S|T|VE))?",yn,Nn].join("|"),"g"),jn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Rn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Dn="object"==typeof $&&$&&$.Object===Object&&$,Un="object"==typeof self&&self&&self.Object===Object&&self,Fn=Dn||Un||Function("return this")();var Bn,Gn=(Bn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"ss"},function(t){return null==Bn?void 0:Bn[t]});function Vn(t){return jn.test(t)}function qn(t){return Vn(t)?function(t){return t.match(Pn)||[]}(t):function(t){return t.split("")}(t)}var zn=Object.prototype.toString,Hn=Fn.Symbol,Wn=Hn?Hn.prototype:void 0,Kn=Wn?Wn.toString:void 0;function Zn(t){if("string"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==zn.call(t)}(t))return Kn?Kn.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}function Xn(t,e,n){var s=t.length;return n=void 0===n?s:n,!e&&n>=s?t:function(t,e,n){var s=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(r);++s<r;)i[s]=t[s+e];return i}(t,e,n)}function Yn(t){return null==t?"":Zn(t)}var Qn,Jn=(Qn=function(t,e,n){return e=e.toLowerCase(),t+(n?es(Yn(e).toLowerCase()):e)},function(t){return function(t,e,n,s){var r=-1,i=t?t.length:0;for(s&&i&&(n=t[++r]);++r<i;)n=e(n,t[r],r,t);return n}(function(t,e,n){return t=Yn(t),void 0===(e=n?void 0:e)?function(t){return Rn.test(t)}(t)?function(t){return t.match(Ln)||[]}(t):function(t){return t.match(hn)||[]}(t):t.match(e)||[]}(function(t){return(t=Yn(t))&&t.replace(pn,Gn).replace(Mn,"")}(t).replace(In,"")),Qn,"")});var ts,es=(ts="toUpperCase",function(t){var e=Vn(t=Yn(t))?qn(t):void 0,n=e?e[0]:t.charAt(0),s=e?Xn(e,1).join(""):t.slice(1);return n[ts]()+s});var ns,ss=(ns=Jn)&&"object"==typeof ns&&"default"in ns?ns.default:ns;function rs(t){return Array.isArray(t)?t:void 0===t?[]:function(t){return function(t){return"object"==typeof t&&null!==t}(t)&&"number"==typeof t.length}(t)?Array.prototype.slice.call(t):[t]}function is(t){return Array.isArray(t)?t:void 0===t?[]:function(t){return function(t){return"object"==typeof t&&null!==t}(t)&&"number"==typeof t.length}(t)?Array.prototype.slice.call(t):[t]}function os(t,e){const n=[],s=is(arguments);return s.splice(0,2),is(t).forEach(((t,r)=>{let i=[];s.forEach((e=>{"function"==typeof e?i=i.concat(e(t)):i.push(e)})),e(t)&&n.push({index:r,replaceWithValue:i})})),n.reverse().forEach((e=>{const n=[e.index,1].concat(e.replaceWithValue);t.splice.apply(t,n)})),t}const as={short:/^-([^\d-])$/,long:/^--(\S+)/,combinedShort:/^-[^\d-]{2,}$/,optEquals:/^(--\S+?)=(.*)/};class cs extends Array{load(t){if(this.clear(),t&&t!==process.argv)t=rs(t);else{t=process.argv.slice(0);const e=process.execArgv.some(ds)?1:2;t.splice(0,e)}t.forEach((t=>this.push(String(t))))}clear(){this.length=0}expandOptionEqualsNotation(){if(this.some((t=>as.optEquals.test(t)))){const t=[];this.forEach((e=>{const n=e.match(as.optEquals);n?t.push(n[1],n[2]):t.push(e)})),this.clear(),this.load(t)}}expandGetoptNotation(){this.hasCombinedShortOptions()&&os(this,as.combinedShort,us)}hasCombinedShortOptions(){return this.some((t=>as.combinedShort.test(t)))}static from(t){const e=new this;return e.load(t),e}}function us(t){return(t=t.slice(1)).split("").map((t=>"-"+t))}function ls(t){return as.optEquals.test(t)}function hs(t){return(as.short.test(t)||as.long.test(t))&&!as.optEquals.test(t)}function ps(t){return as.short.test(t)?t.match(as.short)[1]:function(t){return as.long.test(t)&&!ls(t)}(t)?t.match(as.long)[1]:ls(t)?t.match(as.optEquals)[1].replace(/^--/,""):null}function fs(t){return!(hs(t)||as.combinedShort.test(t)||as.optEquals.test(t))}function ds(t){return["--eval","-e"].indexOf(t)>-1||t.startsWith("--eval=")}function ms(t){return"object"==typeof t&&null!==t}function gs(t){return void 0!==t}function ys(t){return"function"==typeof t}var vs={isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isPlainObject:function(t){return null!==t&&"object"==typeof t&&t.constructor===Object},isArrayLike:function(t){return ms(t)&&"number"==typeof t.length},isObject:ms,isDefined:gs,isFunction:ys,isClass:function(t){return!!ys(t)&&/^class /.test(Function.prototype.toString.call(t))},isPrimitive:function(t){if(null===t)return!0;switch(typeof t){case"string":case"number":case"symbol":case"undefined":case"boolean":return!0;default:return!1}},isPromise:function(t){if(t){const e=gs(Promise)&&t instanceof Promise,n=t.then&&"function"==typeof t.then;return!(!e&&!n)}return!1},isIterable:function(t){return!(null===t||!gs(t))&&("function"==typeof t[Symbol.iterator]||"function"==typeof t[Symbol.asyncIterator])}};class bs{constructor(t){this.name=t.name,this.type=t.type||String,this.alias=t.alias,this.multiple=t.multiple,this.lazyMultiple=t.lazyMultiple,this.defaultOption=t.defaultOption,this.defaultValue=t.defaultValue,this.group=t.group;for(let e in t)this[e]||(this[e]=t[e])}isBoolean(){return this.type===Boolean||vs.isFunction(this.type)&&"Boolean"===this.type.name}isMultiple(){return this.multiple||this.lazyMultiple}static create(t){return new this(t)}}class Es extends Array{validate(){this.some((t=>!t.name))&&ws("INVALID_DEFINITIONS","Invalid option definitions: the `name` property is required on each definition");let t;this.some((t=>t.type&&"function"!=typeof t.type))&&ws("INVALID_DEFINITIONS","Invalid option definitions: the `type` property must be a setter fuction (default: `Boolean`)");this.some((e=>(t=e,vs.isDefined(e.alias)&&vs.isNumber(e.alias))))&&ws("INVALID_DEFINITIONS","Invalid option definition: to avoid ambiguity an alias cannot be numeric [--"+t.name+" alias is -"+t.alias+"]");this.some((e=>(t=e,vs.isDefined(e.alias)&&1!==e.alias.length)))&&ws("INVALID_DEFINITIONS","Invalid option definition: an alias must be a single character");this.some((e=>(t=e,"-"===e.alias)))&&ws("INVALID_DEFINITIONS",'Invalid option definition: an alias cannot be "-"');Os(this.map((t=>t.name)))&&ws("INVALID_DEFINITIONS","Two or more option definitions have the same name");Os(this.map((t=>t.alias)))&&ws("INVALID_DEFINITIONS","Two or more option definitions have the same alias");Os(this.map((t=>t.defaultOption)))&&ws("INVALID_DEFINITIONS","Only one option definition can be the defaultOption");this.some((e=>(t=e,e.isBoolean()&&e.defaultOption)))&&ws("INVALID_DEFINITIONS",`A boolean option ["${t.name}"] can not also be the defaultOption.`)}get(t){return hs(t)?as.short.test(t)?this.find((e=>e.alias===ps(t))):this.find((e=>e.name===ps(t))):this.find((e=>e.name===t))}getDefault(){return this.find((t=>!0===t.defaultOption))}isGrouped(){return this.some((t=>t.group))}whereGrouped(){return this.filter(_s)}whereNotGrouped(){return this.filter((t=>!_s(t)))}whereDefaultValueSet(){return this.filter((t=>vs.isDefined(t.defaultValue)))}static from(t){if(t instanceof this)return t;const e=super.from(rs(t),(t=>bs.create(t)));return e.validate(),e}}function ws(t,e){const n=new Error(e);throw n.name=t,n}function _s(t){return rs(t.group).some((t=>t))}function Os(t){const e={};for(let n=0;n<t.length;n++){const s=t[n];if(e[s])return!0;vs.isDefined(s)&&(e[s]=!0)}}class As{constructor(t,e){this.options=Object.assign({},e),this.definitions=Es.from(t),this.argv=cs.from(this.options.argv),this.argv.hasCombinedShortOptions()&&os(this.argv,as.combinedShort.test.bind(as.combinedShort),(t=>(t=t.slice(1)).split("").map((e=>({origArg:`-${t}`,arg:"-"+e})))))}*[Symbol.iterator](){const t=this.definitions;let e,n,s,r,i,o=!1,a=!1;for(let c of this.argv){if(vs.isPlainObject(c)&&(i=c.origArg,c=c.arg),a&&this.options.stopAtFirstUnknown){yield{event:"unknown_value",arg:c,name:"_unknown",value:void 0};continue}if(hs(c))e=t.get(c),n=void 0,e?(n=!!e.isBoolean()||null,r="set"):r="unknown_option";else if(ls(c)){const s=c.match(as.optEquals);e=t.get(s[1]),e?e.isBoolean()?(yield{event:"unknown_value",arg:c,name:"_unknown",value:n,def:e},r="set",n=!0):(r="set",n=s[2]):r="unknown_option"}else fs(c)&&(e?(n=c,r="set"):(e=this.definitions.getDefault(),e&&!o?(n=c,r="set"):(r="unknown_value",e=void 0)));s=e?e.name:"_unknown";const u={event:r,arg:c,name:s,value:n,def:e};i&&(u.subArg=c,u.arg=i),yield u,"_unknown"===s&&(a=!0),e&&e.defaultOption&&!e.isMultiple()&&"set"===r&&(o=!0),e&&e.isBoolean()&&(e=void 0),e&&!e.multiple&&vs.isDefined(n)&&null!==n&&(e=void 0),n=void 0,r=void 0,s=void 0,i=void 0}}}const Ts=new WeakMap;class Ss{constructor(t){this.definition=new bs(t),this.state=null,this.resetToDefault()}get(){return Ts.get(this)}set(t){this._set(t,"set")}_set(t,e){const n=this.definition;if(n.isMultiple()){if(null!=t){const s=this.get();"default"===this.state&&(s.length=0),s.push(n.type(t)),this.state=e}}else{if(!n.isMultiple()&&"set"===this.state){const e=new Error(`Singular option already set [${this.definition.name}=${this.get()}]`);throw e.name="ALREADY_SET",e.value=t,e.optionName=n.name,e}null==t?Ts.set(this,t):(Ts.set(this,n.type(t)),this.state=e)}}resetToDefault(){vs.isDefined(this.definition.defaultValue)?this.definition.isMultiple()?Ts.set(this,rs(this.definition.defaultValue).slice()):Ts.set(this,this.definition.defaultValue):this.definition.isMultiple()?Ts.set(this,[]):Ts.set(this,null),this.state="default"}static create(t){return(t=new bs(t)).isBoolean()?xs.create(t):new this(t)}}class xs extends Ss{set(t){super.set(!0)}static create(t){return new this(t)}}class $s extends Map{constructor(t){super(),this.definitions=Es.from(t),this.set("_unknown",Ss.create({name:"_unknown",multiple:!0}));for(const t of this.definitions.whereDefaultValueSet())this.set(t.name,Ss.create(t))}toObject(t){t=t||{};const e={};for(const n of this){const s=t.camelCase&&"_unknown"!==n[0]?ss(n[0]):n[0],r=n[1];("_unknown"!==s||r.get().length)&&(e[s]=r.get())}return t.skipUnknown&&delete e._unknown,e}}class Cs extends $s{toObject(t){const e=super.toObject({skipUnknown:t.skipUnknown}),n=super.toObject(t),s=n._unknown;delete n._unknown;const r={_all:n};return s&&s.length&&(r._unknown=s),this.definitions.whereGrouped().forEach((n=>{const s=t.camelCase?ss(n.name):n.name,i=e[n.name];for(const t of rs(n.group))r[t]=r[t]||{},vs.isDefined(i)&&(r[t][s]=i)})),this.definitions.whereNotGrouped().forEach((n=>{const s=t.camelCase?ss(n.name):n.name,i=e[n.name];vs.isDefined(i)&&(r._none||(r._none={}),r._none[s]=i)})),r}}var Ns=function(t,e){(e=e||{}).stopAtFirstUnknown&&(e.partial=!0),t=Es.from(t);const n=new As(t,{argv:e.argv,stopAtFirstUnknown:e.stopAtFirstUnknown}),s=new(t.isGrouped()?Cs:$s)(t);for(const t of n){const n=t.subArg||t.arg;if(!e.partial){if("unknown_value"===t.event){const t=new Error(`Unknown value: ${n}`);throw t.name="UNKNOWN_VALUE",t.value=n,t}if("unknown_option"===t.event){const t=new Error(`Unknown option: ${n}`);throw t.name="UNKNOWN_OPTION",t.optionName=n,t}}let r;s.has(t.name)?r=s.get(t.name):(r=Ss.create(t.def),s.set(t.name,r)),"_unknown"===t.name?r.set(n):r.set(t.value)}return s.toObject({skipUnknown:!e.partial,camelCase:e.camelCase})}([{name:"config",alias:"c",type:String,defaultValue:"presto.config.js",defaultOption:!0},{name:"init",alias:"i",type:Boolean,defaultValue:!1}]);async function ks(n,r){const i=y(n);return".cjs"===e.extname(i)?Is(require(i)):await async function(n,r){const i=t.readFileSync(t.realpathSync(n),{encoding:"utf-8"}),o=s.transform(i,{presets:["@babel/preset-env"]}).code;return async function(n,s){const r=t.realpathSync(n),i=e.extname(r),o=require.extensions[i];require.extensions[i]=(t,e)=>{e===r?t._compile(s,e):o(t,e)},delete require.cache[r];try{const t=Is(require(n));return require.extensions[i]=o,t}catch(t){throw console.log("Failed to load ES module from CommonJS. This is not supported."),t}}(n,o)}(i,r.silent)}function Is(t){return t.__esModule?t.default:t}const Ms=["yes","y"],Ps=["no","n"];function Ls({question:t,defaultValue:e,yesValues:n,noValues:s}){process.stdout.write("\nInvalid Response.\n"),process.stdout.write("Answer either yes : ("+n.join(", ")+") \n"),process.stdout.write("Or no: ("+s.join(", ")+") \n\n")}var js=async function t({question:e,defaultValue:n,yesValues:s,noValues:r,invalid:i}){i&&"function"==typeof i||(i=Ls),s=(s||Ms).map((t=>t.toLowerCase())),r=(r||Ps).map((t=>t.toLowerCase()));const o=g.default.createInterface({input:process.stdin,output:process.stdout});return new Promise((function(a,c){o.question(e+" ",(async function(c){o.close();const u=c.trim().toLowerCase();if(""==u&&null!=n)return a(n);if(s.indexOf(u)>=0)return a(!0);if(r.indexOf(u)>=0)return a(!1);i({question:e,defaultValue:n,yesValues:s,noValues:r});const l=await t({question:e,defaultValue:n,yesValues:s,noValues:r,invalid:i});a(l)}))}))};const Rs={index:'<!DOCTYPE html>\n    <html lang="en">\n      <head>\n        <DocHead />\n      </head>\n      <body>\n        <div\n          x-data="app()"\n          x-init="init()"\n          class="h-screen w-screen grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3"\n        >\n          <MetricCard\n            ::title="Reservoir Level"\n            ::color="blue"\n            ::trend="down"\n            ::glyph="water"\n            ::value="316 FT"\n          ></MetricCard>\n    \n          <MetricCard\n            ::title="Current Output"\n            ::color="yellow"\n            ::trend="up"\n            ::glyph="bolt"\n            ::value="3400 MW"\n          ></MetricCard>\n    \n          <MetricCard\n            $$wrap="template"\n            x-for="m in metrics"\n            ::$title="m.name"\n            ::$color="m.alarm ? \'red\' : \'green\'"\n            ::$trend="m.trend === \'rise\' ? \'up\' : \'down\'"\n            ::$glyph="{turbine: \'fan\', flare_stack: \'fire\', pump: \'faucet\', steam: \'wind\', radiation: \'radiation\'}[m.type]"\n            ::$value="m.value"\n          ></MetricCard>\n        </div>\n      </body>\n      <AlpineSource />\n    </html>',components:{head:'<meta presto name="DocHead" />\n\n        <title>Dashboard</title>\n        <link\n          href="https://unpkg.com/tailwindcss@latest/dist/tailwind.min.css"\n          rel="stylesheet"\n        />\n        <link\n          rel="stylesheet"\n          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"\n        />\n        <script\n          src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@latest/dist/alpine.min.js"\n          defer\n        ><\/script>',alpineSource:'<meta presto name="AlpineSource" />\n\n        <script>\n          const metricsData = `[{"name":"Unit #1 Pri.","trend":"fall","alarm":false,"value":"4,283 RPM","type":"turbine"},{"name":"Unit #1 Sec.","trend":"fall","alarm":false,"value":"4,055 RPM","type":"turbine"},{"name":"Well #3 Relief","trend":"fall","alarm":false,"value":"572 ºC","type":"flare_stack"},{"name":"Toluene Burn-off #2","trend":"fall","alarm":false,"value":"636 ºC","type":"flare_stack"},{"name":"Toluene Burn-off #1","trend":"rise","alarm":false,"value":"623 ºC","type":"flare_stack"},{"name":"Unit #1 LPCI","trend":"fall","alarm":false,"value":"139,357 L/min","type":"pump"},{"name":"Condenser Coolant #1","trend":"rise","alarm":false,"value":"137,889 L/min","type":"pump"},{"name":"Condenser Coolant #2","trend":"fall","alarm":true,"value":"116,146 L/min","type":"pump"},{"name":"Unit #1 Pri. Circuit","trend":"rise","alarm":false,"value":"11 MPa","type":"steam"},{"name":"Unit #1 Sec. Circuit","trend":"rise","alarm":false,"value":"12 MPa","type":"steam"},{"name":"Unit #1 Upper Deck","trend":"rise","alarm":false,"value":"287 Bq","type":"radiation"},{"name":"Unit #1 Relief","trend":"fall","alarm":false,"value":"172 Bq","type":"radiation"},{"name":"Unit #1 Heat Exch.","trend":"fall","alarm":false,"value":"225 Bq","type":"radiation"},{"name":"North Env.","trend":"fall","alarm":false,"value":"361 Bq","type":"radiation"}]`;\n        \n          function app() {\n            return {\n              metrics: [],\n              init() {\n                this.metrics = JSON.parse(metricsData);\n              }\n            };\n          }\n        <\/script>',metricCard:'<meta\n        presto\n        name="MetricCard"\n        ::color="blue"\n        ::title\n        ::glyph\n        ::trend\n        ::value\n      />\n      \n      <div class="w-full p-6">\n        <div\n          class="bg-gradient-to-b from-{{ color }}-200 to-{{ color }}-100 border-b-4 border-{{ color }}-600 rounded-lg shadow-xl p-5"\n        >\n          <div class="flex flex-row items-center">\n            <div class="flex-shrink pr-4">\n            <div class="rounded-full h-16 w-16 flex items-center text-center bg-{{ color }}-600">\n            <i class="fa fa-{{ glyph }} fa-2x fa-inverse mx-auto"></i>\n          </div>\n            </div>\n            <div class="flex-1 text-right md:text-center">\n              <h5 class="font-bold uppercase text-gray-600">{{ title }}</h5>\n              <h3 class="font-bold text-3xl">\n                {{ value }}\n                <span class="text-{{ color }}-500"\n                  ><i class="fas fa-caret-{{ trend }}"></i\n                ></span>\n              </h3>\n            </div>\n          </div>\n        </div>\n      </div>'}};async function Ds(e,n){try{t.realpathSync(e);return await js({question:`A ${n} already exists in your project directory. Do you want to overwrite it?`})}catch(t){return!0}}const Us=y(""),Fs=[Us,"src","presto"].join(e.sep),Bs=[Fs,"components"].join(e.sep),Gs=[Us,"dist"].join(e.sep);async function Vs(){await async function(){const e=y("presto.config.js");await Ds(e,"Presto config file")&&t.writeFileSync(e,"export default {\n    input: 'src/presto/index.html',\n\n    include: [\n        'src/presto/components/**/*.html'\n    ],\n\n    output: {\n        file: 'dist/index.html',\n        formatting: 'none'\n    }\n}")}(),t.mkdirSync(Bs,{recursive:!0}),t.mkdirSync(Gs,{recursive:!0}),await async function(){let n=await js({question:"Do you want to start with some sample components?"});if(!n)return;let s="file named src/presto/",r=`${Fs}${e.sep}index.html`;n=await Ds(r,`${s}index.html`),n&&t.writeFileSync(r,Rs.index),s=`${s}components/`,r=`${Bs}${e.sep}dochead.html`,n=await Ds(r,`${s}dochead.html`),n&&t.writeFileSync(r,Rs.components.head),r=`${Bs}${e.sep}alpinesource.html`,n=await Ds(r,`${s}alpinesource.html`),n&&t.writeFileSync(r,Rs.components.alpineSource),r=`${Bs}${e.sep}metriccard.html`,n=await Ds(r,`${s}metriccard.html`),n&&t.writeFileSync(r,Rs.components.metricCard)}()}!async function(){if(Ns.init)return void Vs();const t=await async function(){try{const t=await ks(Ns.config,!0);return Array.isArray(t)?t:[t]}catch(t){it(t)}}();try{t.map((t=>{new ln(t).outputs.forEach((t=>t.buildBaseExpression()))}))}catch(t){it(t,!0)}}();
